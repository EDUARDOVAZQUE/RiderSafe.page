/* =================================================================
   DASHBOARD STYLESHEET - RiderSafe
   =================================================================
   Estilos específicos para la página del dashboard.
   Este archivo depende de las variables y estilos base definidos en globals.css.
*/

/* ===== 1. ESTRUCTURA PRINCIPAL DEL DASHBOARD ===== */

/* --- ELIMINADO ---
   Se eliminaron las reglas de .main-container, .left-panel, y .right-panel.
   ¿Por qué? Porque tu HTML no usa estas clases. La estructura
   la estamos manejando con las clases de Bootstrap y Flexbox
   directamente en el HTML (ej. d-flex flex-column flex-lg-row).
*/

/* ===== 2. TARJETAS DE ESTADO (STATUS CARDS) ===== */
.status-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(75px, 1fr));
    gap: 0.3rem;
}

.status-card {
    background: var(--card);
    border-radius: var(--radius);
    padding: 0.5rem;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.status-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-md);
}

.status-title {
    font-weight: 550;
    font-size: 0.9rem;
    color: var(--text-secondary);
    text-align: center;
}

.status-value {
    font-size: 0.9rem;
    color: var(--text-secondary);
}

/* --- Indicadores Específicos --- */
.battery-indicator {
    width: 90%;
    height: 20px;
    border: 2px solid var(--text-secondary);
    border-radius: 6px;
    padding: 2px;
}
.battery-level {
    height: 100%;
    background-color: var(--success);
    border-radius: 3px;
    transition: width 0.5s ease;
}

.connection-dot {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    transition: background-color 0.3s ease;
}
.connection-dot.connected {
    background-color: var(--success);
    animation: pulse 1.5s infinite;
}
.connection-dot.disconnected {
    background-color: var(--danger);
}
@keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
    70% { box-shadow: 0 0 0 12px rgba(16, 185, 129, 0); }
    100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
}

.speed-display {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--primary);
    line-height: 1;
}

/* --- Tarjeta de Geocercas --- */
.geofence-card {
    grid-column: 1 / -1;
}
.geofence-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    justify-content: center;
    margin-bottom: 1rem;
}
.geofence-btn {
    border: 1px solid var(--border);
    padding: 0.5rem 1rem;
    border-radius: 50px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.2s;
    background-color: transparent;
}
.geofence-btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-sm); }
.geofence-btn.home { color: #f5faff; border-color: #bee3f8; }
.geofence-btn.work { color: #4a5568; border-color: #e2e8f0; }
.geofence-btn.school { color: #dd6b20; border-color: #feebc8; }
.geofence-btn.shop { color: #38a169; border-color: #c6f6d5; }

.geofence-list { display: flex; flex-direction: column; gap: 0.75rem; margin-bottom: 1rem; }
.geofence-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem;
    background-color: var(--background);
    border-radius: var(--radius-md);
}
.geofence-status { font-weight: 600; padding: 0.1rem 0.5rem; border-radius: 25px; font-size: 0.8rem; }
.geofence-status.inside { background-color: var(--success); color: white; }
.geofence-status.outside { background-color: var(--border); color: var(--text-secondary); }

.edit-btn {
    background: transparent;
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    width: 100%;
    padding: 0.5rem;
    cursor: pointer;
    transition: background-color 0.2s, color 0.2s;
}
.edit-btn:hover { background-color: var(--danger); color: var(--primary); }


/* ===== 3. COMPONENTES VISUALES (MAPA Y 3D) ===== */
.map-container {
    background: var(--card);
    border-radius: var(--radius);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border);
    padding: 0.15rem;
    /* AQUÍ ESTÁ LA CORRECCIÓN:
      Cambiado de '170%' a '100%'.
      Esto permite que las clases 'h-100' y 'h-50' del HTML 
      controlen la altura correctamente.
    */
    height: 100%; 
}

/* --- ELIMINADO ---
   Se eliminó .map-header y las reglas de flex-grow de #map.
   ¿Por qué? Tu HTML maneja el header del mapa con 'position: absolute'
   y z-index, por lo que estas reglas de CSS no son necesarias y
   pueden causar conflictos.
*/

#map {
    width: 100%;
    height: 100%; /* Aseguramos que llene el .map-container */
    border-radius: var(--radius-md);
    border: 1px solid var(--border);
}


.model-container {
    background: var(--card);
    border-radius: var(--radius);
    padding: 0.5rem; 
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    align-items: center;
}
#3Dmodel { 
    width: 100%;
    height: 150px; 
    margin-bottom: 1rem;
}
#3Dmodel canvas { border-radius: var(--radius-md); }

#tiltSlider {
    -webkit-appearance: none; appearance: none;
    width: 90%;
    height: 8px;
    background: var(--border);
    border-radius: 5px;
    outline: none;
    margin-top: 20px; /* <-- Ajusta este valor */
}
#tiltSlider::-webkit-slider-thumb {
    -webkit-appearance: none; appearance: none;
    width: 20px; height: 20px;
    background: var(--primary);
    border-radius: 50%;
    cursor: pointer;
}
#sliderValue { 
    font-weight: 700; 
    font-size: 1.2rem; 
    margin-top: 0.5rem; 
}


/* ===== 4. ESTILOS DEL MODAL ===== */
.modal-overlay {
    visibility: hidden; opacity: 0;
    position: fixed;
    z-index: 1050;
    inset: 0;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
    transition: opacity 0.3s ease, visibility 0.3s ease;
}
.modal-overlay.show { visibility: visible; opacity: 1; }

.modal-content {
    background: var(--card);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
    width: 90%;
    max-width: 800px;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    animation: modalSlideIn 0.3s ease-out;
}
@keyframes modalSlideIn {
    from { transform: translateY(-30px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.25rem 1.5rem;
    border-bottom: 1px solid var(--border);
}
.modal-header h2 { margin: 0; font-size: 1.5rem; }
.close-btn {
    background: none; border: none; font-size: 2rem;
    color: var(--text-secondary); cursor: pointer;
    transition: transform 0.2s ease, color 0.2s ease;
}
.close-btn:hover { color: var(--text-primary); transform: rotate(90deg); }

#modal-map { width: 100%; height: 500px; flex-shrink: 0; }
.modal-controls {
    padding: 1.5rem;
    display: flex;
    gap: 1.5rem;
    background: var(--background);
}
.modal-controls > div { flex: 1; }
.modal-controls label { font-weight: 600; font-size: 0.9rem; color: var(--text-secondary); }

/* ===== 5. DISEÑO RESPONSIVO ===== */

@media (max-width: 768px) {
    /* Esto está perfecto para móviles */
    .status-grid { grid-template-columns: repeat(2, 1fr); }
    .geofence-card { grid-column: 1 / -1; }
    .speed-display { font-size: 2.5rem; }
}

/* AQUÍ ESTÁ LA SOLUCIÓN 80/20 
  (Solo se aplica en pantallas 'lg' de 992px o más)
*/
@media (min-width: 992px) {
  
  /* REGLA NUEVA: Le decimos al mapa que ocupe el 80% */
  .map-panel {
    width: 70%;
  }

  /* REGLA MODIFICADA: Le decimos al panel que ocupe el 20% */
  .info-panel-lg-fixed {
    width: 30%;
    
    /* Esto sigue igual: le dice que no crezca ni se encoja */
    flex-grow: 0;
    flex-shrink: 0;
  }
}

/* =========================================
   ESTILOS DE ALERTAS (TOAST NOTIFICATIONS)
   ========================================= */

/* El contenedor invisible que agrupa las alertas */
.alert-container {
    position: fixed;
    top: auto;      /* CAMBIO: Ya no usamos top */
    bottom: 20px;   /* CAMBIO: Fijamos al fondo de la pantalla */
    right: 20px;    /* Fijamos a la derecha */
    z-index: 9999;  /* Por encima de todo */
    display: flex;
    
    /* Las alertas nuevas aparecen abajo y empujan a las viejas hacia arriba */
    flex-direction: column; 
    justify-content: flex-end; 
    
    gap: 10px;
    pointer-events: none; /* Permite hacer clic "a través" del contenedor */
}

/* La tarjeta de alerta base */
.alert-toast {
    background: white;
    color: #333;
    padding: 12px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    font-weight: 500;
    min-width: 250px;
    max-width: 350px;
    opacity: 0; /* Invisible al inicio */
    transform: translateX(50px); /* Desplazado a la derecha */
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55); /* Animación "rebote" */
    pointer-events: auto; /* La tarjeta sí recibe clics */
    border-left: 5px solid #ccc;
    display: flex;
    align-items: center;
}

/* Clase para mostrar la alerta (JS la añade) */
.alert-toast.show {
    opacity: 1;
    transform: translateX(0);
}

/* --- Tipos de Alerta (Colores) --- */

/* Error (Rojo) - Para caídas y errores */
.alert-toast.error {
    border-left-color: #dc3545;
    background-color: #fff5f5;
    color: #c53030;
}

/* Success (Verde) - Para desbloqueo o guardado */
.alert-toast.success {
    border-left-color: #198754;
    background-color: #f0fff4;
    color: #2f855a;
}

/* Enter (Azul) - Entrar a Geocerca */
.alert-toast.enter {
    border-left-color: #0d6efd;
    background-color: #ebf8ff;
    color: #2b6cb0;
}

/* Exit (Naranja) - Salir de Geocerca */
.alert-toast.exit {
    border-left-color: #fd7e14;
    background-color: #fffaf0;
    color: #c05621;
}
/* Agrega esto a tu CSS si no lo tienes */
.alert-toast.warning {
    background-color: #fff3cd; /* Fondo amarillo claro */
    color: #856404;            /* Texto amarillo oscuro */
    border-left: 5px solid #ffc107; /* Borde izquierdo amarillo intenso */
}

/* Referencia de los otros estilos que probablemente ya tienes: */
/* .alert-toast.error { background-color: #f8d7da; ... border-left: 5px solid #dc3545; } */
/* .alert-toast.success { background-color: #d4edda; ... border-left: 5px solid #28a745; } */