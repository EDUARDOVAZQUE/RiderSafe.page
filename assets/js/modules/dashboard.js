const a4_0x261970=a4_0x18ff;(function(_0x111dc4,_0x25c6fd){const _0x2e7f5c=a4_0x18ff,_0x2b34f0=_0x111dc4();while(!![]){try{const _0x51fb48=parseInt(_0x2e7f5c(0x1ed))/0x1*(parseInt(_0x2e7f5c(0x281))/0x2)+parseInt(_0x2e7f5c(0x1b9))/0x3+parseInt(_0x2e7f5c(0x1a3))/0x4+parseInt(_0x2e7f5c(0x283))/0x5+-parseInt(_0x2e7f5c(0x1c3))/0x6+-parseInt(_0x2e7f5c(0x287))/0x7*(-parseInt(_0x2e7f5c(0x1e9))/0x8)+-parseInt(_0x2e7f5c(0x20b))/0x9*(parseInt(_0x2e7f5c(0x293))/0xa);if(_0x51fb48===_0x25c6fd)break;else _0x2b34f0['push'](_0x2b34f0['shift']());}catch(_0x3965e5){_0x2b34f0['push'](_0x2b34f0['shift']());}}}(a4_0x1683,0x47381));const a4_0x4398c1=(function(){let _0x4355a6=!![];return function(_0x4efef1,_0x4a3d27){const _0x209c63=_0x4355a6?function(){const _0x44426f=a4_0x18ff;if(_0x4a3d27){const _0x36d3e1=_0x4a3d27[_0x44426f(0x1a6)](_0x4efef1,arguments);return _0x4a3d27=null,_0x36d3e1;}}:function(){};return _0x4355a6=![],_0x209c63;};}()),a4_0x13cdd3=a4_0x4398c1(this,function(){const _0x21cb22=a4_0x18ff;return a4_0x13cdd3[_0x21cb22(0x1c2)]()['search'](_0x21cb22(0x231))[_0x21cb22(0x1c2)]()[_0x21cb22(0x1d1)](a4_0x13cdd3)[_0x21cb22(0x28b)](_0x21cb22(0x231));});a4_0x13cdd3();const a4_0x1522d7=(function(){let _0x7b2ca4=!![];return function(_0x447685,_0x3d8a50){const _0x27545b=_0x7b2ca4?function(){const _0x54794e=a4_0x18ff;if(_0x3d8a50){const _0x62ad68=_0x3d8a50[_0x54794e(0x1a6)](_0x447685,arguments);return _0x3d8a50=null,_0x62ad68;}}:function(){};return _0x7b2ca4=![],_0x27545b;};}());(function(){a4_0x1522d7(this,function(){const _0x447e0e=a4_0x18ff,_0x166c42=new RegExp(_0x447e0e(0x31c)),_0xcc6482=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x10a439=a4_0x9da99d(_0x447e0e(0x233));!_0x166c42[_0x447e0e(0x1c0)](_0x10a439+_0x447e0e(0x313))||!_0xcc6482[_0x447e0e(0x1c0)](_0x10a439+_0x447e0e(0x1f3))?_0x10a439('0'):a4_0x9da99d();})();}());const a4_0x3fde87=(function(){let _0x1f9e3a=!![];return function(_0x55f971,_0x4b859f){const _0x247bd2=_0x1f9e3a?function(){const _0x3c009f=a4_0x18ff;if(_0x4b859f){const _0x5d4220=_0x4b859f[_0x3c009f(0x1a6)](_0x55f971,arguments);return _0x4b859f=null,_0x5d4220;}}:function(){};return _0x1f9e3a=![],_0x247bd2;};}()),a4_0x1d686f=a4_0x3fde87(this,function(){const _0x11c272=a4_0x18ff,_0x5f442d=function(){const _0x9a2ee9=a4_0x18ff;let _0x38bfe6;try{_0x38bfe6=Function(_0x9a2ee9(0x24c)+_0x9a2ee9(0x278)+');')();}catch(_0x1c398e){_0x38bfe6=window;}return _0x38bfe6;},_0x3d1bc3=_0x5f442d(),_0x78e74=_0x3d1bc3[_0x11c272(0x22e)]=_0x3d1bc3[_0x11c272(0x22e)]||{},_0x476380=[_0x11c272(0x1a8),_0x11c272(0x24f),_0x11c272(0x31e),_0x11c272(0x2f5),_0x11c272(0x2e4),'table',_0x11c272(0x29a)];for(let _0xf639bb=0x0;_0xf639bb<_0x476380[_0x11c272(0x1dc)];_0xf639bb++){const _0x34f783=a4_0x3fde87[_0x11c272(0x1d1)]['prototype'][_0x11c272(0x2c0)](a4_0x3fde87),_0x83ac3f=_0x476380[_0xf639bb],_0x2157bf=_0x78e74[_0x83ac3f]||_0x34f783;_0x34f783['__proto__']=a4_0x3fde87['bind'](a4_0x3fde87),_0x34f783[_0x11c272(0x1c2)]=_0x2157bf['toString'][_0x11c272(0x2c0)](_0x2157bf),_0x78e74[_0x83ac3f]=_0x34f783;}});a4_0x1d686f();import{db}from'../config/firebase-config.js';import{doc,onSnapshot,getDoc,collection,updateDoc,GeoPoint,setDoc,getDocs,query,orderBy,limit}from'https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js';import{getCurrentUser,getUserData,activateProductCode}from'./auth.js';function a4_0x18ff(_0xac7810,_0x15a26f){const _0x5813b6=a4_0x1683();return a4_0x18ff=function(_0x1d686f,_0x3fde87){_0x1d686f=_0x1d686f-0x191;let _0x442124=_0x5813b6[_0x1d686f];return _0x442124;},a4_0x18ff(_0xac7810,_0x15a26f);}let map,motorcycleMarker,model,scene,camera,renderer,followState=!![],connectionTimeout=null,currentVehicleId=null,unsubscribeFirestore=null,currentVehicleGeofences=[],geofenceLayers=[],modalMap=null,activeEditingGeofence={'marker':null,'circle':null},historyMapToday=null,activeEditingGeofenceSlot=null,geofenceModalInstance=null,historyMapYesterday=null,lastTiltZone=a4_0x261970(0x2b5),batteryChartInstance=null,isVehicleLocked=![],isTogglingLock=![],lastLockedLocation=null,whatsappAlertsEnabled=!![];const waPhone=a4_0x261970(0x1b8),waApiKey=a4_0x261970(0x20c);function updateHeaderUI(_0x570de2){const _0x1df14=a4_0x261970,_0x5193ec=document['getElementById'](_0x1df14(0x21c)),_0x47eeca=document['getElementById'](_0x1df14(0x1e1)),_0x3ac4b0=document[_0x1df14(0x236)]('dashboardLink');if(!_0x5193ec||!_0x47eeca||!_0x3ac4b0){console[_0x1df14(0x24f)](_0x1df14(0x267));return;}_0x570de2?(_0x5193ec[_0x1df14(0x271)]['display']=_0x1df14(0x2ef),_0x47eeca[_0x1df14(0x271)][_0x1df14(0x2cd)]='block',_0x3ac4b0[_0x1df14(0x271)][_0x1df14(0x2cd)]='block'):(_0x5193ec['style'][_0x1df14(0x2cd)]='block',_0x47eeca[_0x1df14(0x271)][_0x1df14(0x2cd)]='none',_0x3ac4b0[_0x1df14(0x271)][_0x1df14(0x2cd)]=_0x1df14(0x2ef));}async function initDashboard(){const _0x4b131d=a4_0x261970;console[_0x4b131d(0x1a8)](_0x4b131d(0x228));const _0x3bc8f3=getCurrentUser();updateHeaderUI(_0x3bc8f3);if(!_0x3bc8f3){console[_0x4b131d(0x2f5)](_0x4b131d(0x310));return;}const _0x26d608=await getUserData(_0x3bc8f3[_0x4b131d(0x2cc)]);if(!_0x26d608){console[_0x4b131d(0x2f5)]('[Dashboard]\x20No\x20se\x20pudieron\x20obtener\x20los\x20datos\x20del\x20usuario.');return;}!_0x26d608[_0x4b131d(0x21d)]||_0x26d608[_0x4b131d(0x21d)][_0x4b131d(0x1dc)]===0x0?(console[_0x4b131d(0x1a8)](_0x4b131d(0x239)),showActivationForm()):(console[_0x4b131d(0x1a8)](_0x4b131d(0x2a6)+_0x26d608[_0x4b131d(0x21d)][_0x4b131d(0x1dc)]+_0x4b131d(0x1f1)),showDashboardView(),initializeAllComponents(),await populateVehicleDropdown(_0x26d608['vehicles']));}function showActivationForm(){const _0x197794=a4_0x261970,_0x40c4b0=document['getElementById'](_0x197794(0x23e)),_0x45b343=document['getElementById'](_0x197794(0x2e0));if(_0x40c4b0)_0x40c4b0[_0x197794(0x271)][_0x197794(0x2cd)]=_0x197794(0x292);if(_0x45b343)_0x45b343['style'][_0x197794(0x2cd)]='none';const _0x4c4d28=document[_0x197794(0x236)](_0x197794(0x203));if(_0x4c4d28){_0x4c4d28['onsubmit']=handleActivationSubmit;let _0x553bea=document[_0x197794(0x236)](_0x197794(0x2ab));!_0x553bea&&(_0x553bea=document[_0x197794(0x2ca)](_0x197794(0x192)),_0x553bea[_0x197794(0x19e)]=_0x197794(0x192),_0x553bea['id']=_0x197794(0x2ab),_0x553bea[_0x197794(0x2b6)]=_0x197794(0x258),_0x553bea[_0x197794(0x260)]='Cancelar',_0x4c4d28[_0x197794(0x1ef)](_0x553bea)),_0x553bea['onclick']=()=>{const _0x4e2c30=_0x197794;if(currentVehicleId){showDashboardView();const _0x490e76=document[_0x4e2c30(0x236)]('vehicle-select');_0x490e76[_0x4e2c30(0x279)]=currentVehicleId;}};}}function showDashboardView(){const _0x58d65a=a4_0x261970,_0x145cdb=document['getElementById'](_0x58d65a(0x23e)),_0x35be47=document[_0x58d65a(0x236)](_0x58d65a(0x2e0));if(_0x145cdb)_0x145cdb[_0x58d65a(0x271)][_0x58d65a(0x2cd)]=_0x58d65a(0x2ef);if(_0x35be47)_0x35be47['style']['display']=_0x58d65a(0x292);}async function handleActivationSubmit(_0x4e64cb){const _0x4a415e=a4_0x261970;_0x4e64cb[_0x4a415e(0x216)]();const _0x15512c=_0x4e64cb['target'],_0x4ad35e=document[_0x4a415e(0x236)](_0x4a415e(0x1c1)),_0x237f61=_0x15512c[_0x4a415e(0x246)](_0x4a415e(0x238)),_0x5212ec=document[_0x4a415e(0x236)](_0x4a415e(0x204)),_0x478174=document['getElementById']('activation-success'),_0xaec647=_0x4ad35e[_0x4a415e(0x279)][_0x4a415e(0x195)]();if(!_0xaec647){_0x5212ec[_0x4a415e(0x260)]='Por\x20favor,\x20ingresa\x20un\x20c√≥digo\x20de\x20activaci√≥n.',_0x5212ec[_0x4a415e(0x271)][_0x4a415e(0x2cd)]=_0x4a415e(0x292);return;}_0x5212ec[_0x4a415e(0x271)][_0x4a415e(0x2cd)]='none',_0x478174['style'][_0x4a415e(0x2cd)]='none',_0x237f61[_0x4a415e(0x1e6)]=!![],_0x237f61[_0x4a415e(0x260)]=_0x4a415e(0x1f7);try{const _0x47f37e=await activateProductCode(_0xaec647);_0x47f37e[_0x4a415e(0x213)]?(_0x478174[_0x4a415e(0x260)]=_0x4a415e(0x198)+_0x47f37e[_0x4a415e(0x226)][_0x4a415e(0x25f)]()+'\x20registrado.\x20Recargando...',_0x478174['style']['display']=_0x4a415e(0x292),setTimeout(()=>window[_0x4a415e(0x202)][_0x4a415e(0x2f9)](),0x9c4)):(_0x5212ec[_0x4a415e(0x260)]=_0x47f37e['error'],_0x5212ec['style']['display']='block');}catch(_0x373252){_0x5212ec[_0x4a415e(0x260)]=_0x4a415e(0x318),_0x5212ec['style']['display']='block';}finally{(!_0x478174[_0x4a415e(0x271)][_0x4a415e(0x2cd)]||_0x478174[_0x4a415e(0x271)]['display']===_0x4a415e(0x2ef))&&(_0x237f61[_0x4a415e(0x1e6)]=![],_0x237f61[_0x4a415e(0x260)]='Activar\x20C√≥digo');}}function initializeAllComponents(){updateUIWithDefaults(),initMap(),init3D(),setupEventListeners();}async function populateVehicleDropdown(_0x123b0d){const _0x3c05a4=a4_0x261970,_0x5eff44=document[_0x3c05a4(0x236)](_0x3c05a4(0x199));_0x5eff44[_0x3c05a4(0x23b)]='';const _0xb18a7a=new Option(_0x3c05a4(0x277),_0x3c05a4(0x28a));_0x5eff44['add'](_0xb18a7a);const _0x2d89b3=_0x123b0d['map'](async _0x43e79f=>{const _0x56615e=_0x3c05a4;try{const _0xf22dac=doc(db,_0x56615e(0x30e),_0x43e79f),_0x453675=await getDoc(_0xf22dac);if(_0x453675[_0x56615e(0x1ec)]()){const _0x2cb815=_0x453675['data']()['friendlyName']||_0x43e79f;return{'id':_0x43e79f,'name':_0x2cb815};}return null;}catch(_0x32eda5){return console[_0x56615e(0x2f5)](_0x56615e(0x30b)+_0x43e79f+':',_0x32eda5),null;}}),_0x3a41b8=(await Promise[_0x3c05a4(0x20a)](_0x2d89b3))[_0x3c05a4(0x219)](_0x4a2ed2=>_0x4a2ed2!==null);_0x3a41b8['forEach'](_0x20c3d5=>{const _0x1e0270=_0x3c05a4,_0x202f25=new Option(_0x20c3d5[_0x1e0270(0x302)],_0x20c3d5['id']);_0x5eff44[_0x1e0270(0x24e)](_0x202f25);});if(_0x3a41b8[_0x3c05a4(0x1dc)]>0x0){const _0x47b1a3=_0x3a41b8[0x0]['id'];_0x5eff44[_0x3c05a4(0x279)]=_0x47b1a3,await switchVehicle(_0x47b1a3);}}async function switchVehicle(_0x2033d9){const _0xad8b31=a4_0x261970;if(!_0x2033d9)return;if(_0x2033d9===_0xad8b31(0x28a)){showActivationForm();return;}console[_0xad8b31(0x1a8)]('[Dashboard]\x20Cambiando\x20a\x20veh√≠culo:\x20'+_0x2033d9),currentVehicleId=_0x2033d9,unsubscribeFirestore&&(console[_0xad8b31(0x1a8)]('[Firestore]\x20Deteniendo\x20listener\x20anterior.'),unsubscribeFirestore(),unsubscribeFirestore=null),updateUIWithDefaults(),setupFirestoreListener(_0x2033d9),loadVehicleHistory(_0x2033d9);}function setupFirestoreListener(_0x4c5941){const _0x58f7f6=a4_0x261970;if(!_0x4c5941){console[_0x58f7f6(0x2f5)]('El\x20ID\x20del\x20veh√≠culo\x20es\x20inv√°lido.\x20No\x20se\x20puede\x20escuchar\x20actualizaciones.');return;}console['log'](_0x58f7f6(0x320)+_0x4c5941);const _0x54fc2d=doc(db,'dispositivos',_0x4c5941);unsubscribeFirestore=onSnapshot(_0x54fc2d,_0x4479dc=>{const _0x179d71=_0x58f7f6;if(_0x4479dc[_0x179d71(0x1ec)]()){const _0xe53677=_0x4479dc[_0x179d71(0x2d1)]();clearTimeout(connectionTimeout),updateConnectionStatus(!![]),connectionTimeout=setTimeout(()=>{const _0x3fd21b=_0x179d71;console[_0x3fd21b(0x24f)](_0x3fd21b(0x1bc)),updateConnectionStatus(![]);},0x2710);const _0x222afc=parseGeofencesFromDoc(_0xe53677);updateUIFromData(_0xe53677,_0x222afc);}else console[_0x179d71(0x2f5)](_0x179d71(0x285)+_0x4c5941+_0x179d71(0x2a3)),updateConnectionStatus(![]),updateUIWithDefaults();},_0x41ec7a=>{const _0x3e5def=_0x58f7f6;console[_0x3e5def(0x2f5)](_0x3e5def(0x1aa),_0x41ec7a),updateConnectionStatus(![]);});}function setupEventListeners(){const _0x4ac30c=a4_0x261970,_0x118a51=document[_0x4ac30c(0x236)](_0x4ac30c(0x270));_0x118a51&&_0x118a51['addEventListener'](_0x4ac30c(0x2a2),_0x6a3afc=>{const _0x46f168=_0x4ac30c;followState=_0x6a3afc[_0x46f168(0x1d7)][_0x46f168(0x296)];});const _0x589c14=document['getElementById'](_0x4ac30c(0x199));_0x589c14&&_0x589c14[_0x4ac30c(0x264)](_0x4ac30c(0x2a2),_0x56fb0a=>{const _0x12a721=_0x4ac30c,_0x393473=_0x56fb0a['target'][_0x12a721(0x279)];switchVehicle(_0x393473);});setupModal();const _0x1f474b=document[_0x4ac30c(0x236)](_0x4ac30c(0x27f)),_0x23bdd4=document[_0x4ac30c(0x236)](_0x4ac30c(0x220)),_0x4504f6=document[_0x4ac30c(0x236)](_0x4ac30c(0x30f));_0x1f474b&&(_0x1f474b['onclick']=()=>toggleVehicleNameEdit(!![])),_0x23bdd4&&(_0x23bdd4['onclick']=()=>handleSaveVehicleName()),_0x4504f6&&(_0x4504f6['onclick']=()=>toggleVehicleNameEdit(![]));}const demoBtn=document['getElementById'](a4_0x261970(0x26d));demoBtn&&(demoBtn['onclick']=()=>{const _0x4c42c8=a4_0x261970;notificationSound[_0x4c42c8(0x247)]()['then'](()=>{const _0x5cd6b5=_0x4c42c8;notificationSound[_0x5cd6b5(0x301)](),notificationSound['currentTime']=0x0,console[_0x5cd6b5(0x1a8)](_0x5cd6b5(0x29c));})[_0x4c42c8(0x262)](_0x1ff962=>console['warn'](_0x4c42c8(0x1f5),_0x1ff962)),confirm(_0x4c42c8(0x1ce))&&runDemoRoute();});const lockCard=document[a4_0x261970(0x236)](a4_0x261970(0x1d9));lockCard&&(lockCard[a4_0x261970(0x1c4)]=toggleMotorLock);const waCheckbox=document[a4_0x261970(0x236)]('whatsapp-toggle');waCheckbox&&(waCheckbox[a4_0x261970(0x296)]=whatsappAlertsEnabled,waCheckbox['addEventListener'](a4_0x261970(0x2a2),_0x27b497=>{const _0x41efdb=a4_0x261970;whatsappAlertsEnabled=_0x27b497[_0x41efdb(0x1d7)][_0x41efdb(0x296)],whatsappAlertsEnabled?showAlert('Alertas\x20de\x20WhatsApp\x20ACTIVADAS','success'):showAlert(_0x41efdb(0x2c4),_0x41efdb(0x1b7)),console[_0x41efdb(0x1a8)](_0x41efdb(0x1df),whatsappAlertsEnabled);}));function updateUIWithDefaults(){updateBattery(0x0),updateSpeed(0x0),updateModelTilt(0x0),updateSliderUI(0x0),updateConnectionStatus(![]),currentVehicleGeofences=[],updateGeofenceListUI([]),drawGeofencesOnMap([]),clearHistoryUI();}function updateBattery(_0x3ad34b){const _0x3e754d=a4_0x261970;document[_0x3e754d(0x236)]('batteryLevel')['style']['width']=_0x3ad34b+'%',document[_0x3e754d(0x236)](_0x3e754d(0x2be))[_0x3e754d(0x260)]=_0x3ad34b+'%';}function updateSpeed(_0x2801f9){const _0x33de21=a4_0x261970;document[_0x33de21(0x236)](_0x33de21(0x29d))[_0x33de21(0x260)]=_0x2801f9;}function updateConnectionStatus(_0x4d6bae){const _0x38a978=a4_0x261970,_0x3ec624=document[_0x38a978(0x236)]('deviceConnection'),_0x5ad0a8=document[_0x38a978(0x236)]('deviceStatusText');_0x4d6bae?(_0x3ec624[_0x38a978(0x2b6)]=_0x38a978(0x1c9),_0x5ad0a8['textContent']=_0x38a978(0x24d)):(_0x3ec624[_0x38a978(0x2b6)]=_0x38a978(0x2e3),_0x5ad0a8[_0x38a978(0x260)]=_0x38a978(0x2ee));}function updateSliderUI(_0x4d3d72){const _0x527eaa=a4_0x261970,_0x836054=document['getElementById']('tiltSlider'),_0x4204bb=document[_0x527eaa(0x236)](_0x527eaa(0x1a9));let _0x5dac4f='#f56565';if(_0x4d3d72>=-0x14&&_0x4d3d72<=0x14)_0x5dac4f='#48bb78';else{if(_0x4d3d72>0x14&&_0x4d3d72<=0x2d||_0x4d3d72<-0x14&&_0x4d3d72>=-0x2d)_0x5dac4f=_0x527eaa(0x212);}_0x836054['value']=_0x4d3d72,_0x4204bb['textContent']=_0x4d3d72+'¬∞',_0x4204bb['style']['color']=_0x5dac4f;}function initMap(){const _0x5e8b46=a4_0x261970,_0x2bc04b=[20.138,-99.2015];map=L[_0x5e8b46(0x26a)](_0x5e8b46(0x26a))[_0x5e8b46(0x31d)](_0x2bc04b,0xf),L[_0x5e8b46(0x200)]('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{'attribution':'&copy;\x20<a\x20href=\x22https://www.openstreetmap.org/copyright\x22>OpenStreetMap</a>'})[_0x5e8b46(0x2d2)](map);const _0x41f36d=L[_0x5e8b46(0x300)]({'html':'üèçÔ∏è','className':_0x5e8b46(0x229),'iconSize':[0x32,0x32],'iconAnchor':[0x32,0x32]});motorcycleMarker=L[_0x5e8b46(0x22a)](_0x2bc04b,{'icon':_0x41f36d})[_0x5e8b46(0x2d2)](map),drawGeofencesOnMap();}function updateMapLocation(_0x42c77f,_0x3e9072){const _0x4c046d=a4_0x261970,_0x52d721=[_0x42c77f,_0x3e9072];if(motorcycleMarker){motorcycleMarker[_0x4c046d(0x206)](_0x52d721);if(followState)map[_0x4c046d(0x2e8)](_0x52d721);}}function init3D(){const _0x4b98a1=a4_0x261970,_0x119f94=document[_0x4b98a1(0x236)](_0x4b98a1(0x1fd));scene=new THREE['Scene'](),scene[_0x4b98a1(0x25c)]=new THREE[(_0x4b98a1(0x21b))](0xf0f0f0),camera=new THREE[(_0x4b98a1(0x2bc))](0x13,0x190/0x12c,0xa,0x12c),camera[_0x4b98a1(0x2d7)][_0x4b98a1(0x1e5)](-0xe,0xe,0x0),camera[_0x4b98a1(0x1b3)](0x0,0x0,0x0),renderer=new THREE[(_0x4b98a1(0x19c))]({'antialias':!![]}),renderer[_0x4b98a1(0x223)](0x190,0x12c),_0x119f94[_0x4b98a1(0x1ef)](renderer['domElement']);const _0x147325=new THREE[(_0x4b98a1(0x19f))](0xffffff,0x1);scene['add'](_0x147325);const _0x52da63=new THREE[(_0x4b98a1(0x248))](0xffffff,0x444444,0x1);scene[_0x4b98a1(0x24e)](_0x52da63);const _0x2aaf41=new THREE['DirectionalLight'](0xffffff,0x1);_0x2aaf41[_0x4b98a1(0x2d7)][_0x4b98a1(0x1e5)](0x5,0x5,0x5),scene['add'](_0x2aaf41);const _0x236cbd=new THREE[(_0x4b98a1(0x29e))]();_0x236cbd[_0x4b98a1(0x317)](_0x4b98a1(0x29f),_0x230cf5=>{const _0x7bc1b9=_0x4b98a1;model=_0x230cf5,model[_0x7bc1b9(0x286)][_0x7bc1b9(0x1e5)](0.6,0.6,0.6),model['position'][_0x7bc1b9(0x1e5)](0x2,-2.5,0x0),scene['add'](model);},undefined,_0x579513=>console[_0x4b98a1(0x2f5)](_0x4b98a1(0x224),_0x579513)),animate3D();}function updateModelTilt(_0x3b7acb){const _0x51eef0=a4_0x261970;if(model)model[_0x51eef0(0x29b)]['x']=_0x3b7acb*Math['PI']/0xb4;}function animate3D(){const _0x15d688=a4_0x261970;requestAnimationFrame(animate3D),renderer[_0x15d688(0x1a5)](scene,camera);}function a4_0x1683(){const _0x256cb5=['#4299e1','logoutBtn','show','\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x20text-center\x20p-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small\x20class=\x22text-muted\x20fw-bold\x22>BATER√çA</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22display-6\x20fw-bold\x20text-','forEach','set','disabled','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22row\x20g-3\x20mb-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22col-md-3\x20col-6\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x20h-100\x20border-','</b><br>Duraci√≥n:\x20','1496NvacjV','üîì\x20Desbloqueo','Hoy','exists','36489qbyxKV','push','appendChild','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x20mb-2\x22\x20id=\x22geofence-item-','\x20veh√≠culo(s).','0\x20km/h','input','includes','‚ö†Ô∏è\x20No\x20se\x20pudo\x20desbloquear\x20audio:','Motor\x20Bloqueado','Activando...','&apikey=','transitionend','<li\x20class=\x22list-group-item\x20text-muted\x22>No\x20se\x20registraron\x20paradas.</li>','geofence-name-input','message','3Dmodel','counter','En\x20ruta...','tileLayer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22col-lg-5\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h5\x20class=\x22mb-3\x22>Paradas\x20y\x20Duraci√≥n</h5>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20class=\x22list-group\x22\x20style=\x22max-height:\x20400px;\x20overflow-y:\x20auto;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','location','activation-form','activation-error','classList','setLatLng','üî•\x20¬°Evento\x20aleatorio:\x20CA√çDA!','\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x20text-center\x20p-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small\x20class=\x22text-muted\x20fw-bold\x22>SEGURIDAD</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22display-6\x20fw-bold\x20text-','<i\x20class=\x22bi\x20bi-lock-fill\x20text-danger\x22\x20style=\x22font-size:\x202rem;\x22></i>','all','6682122dekrtn','5859614','onchange','0\x20km','Error\x20al\x20cargar\x20el\x20historial:','routePoints','history-today-pane','#ed8936','success','Demo\x20finalizada.\x20Revisa\x20la\x20pesta√±a\x20de\x20An√°lisis.','vehicle-name-display','preventDefault','<i\x20class=\x22bi\x20bi-unlock-fill\x20text-success\x22\x20style=\x22font-size:\x202rem;\x22></i>','enter','filter','activado','Color','loginBtn','vehicles','insertAdjacentHTML','geofence-status\x20','save-name-btn','summary','Latitud\x20(-90\x20a\x2090)\x20o\x20Longitud\x20(-180\x20a\x20180)\x20inv√°lida.','setSize','Error\x20al\x20cargar\x20el\x20modelo\x203D:','3.2\x20km\x20(Demo)','plan','&text=','[Dashboard]\x20Inicializando...','leaflet-div-icon','marker','history-yesterday-pane','batteryChart','radius','console','vehicle-name-view','toLocaleDateString','(((.+)+)+)+$','latitude','init','text','setDate','getElementById','alert-container','button[type=\x22submit\x22]','[Dashboard]\x20Usuario\x20sin\x20veh√≠culos.\x20Mostrando\x20formulario\x20de\x20activaci√≥n.','distance','innerHTML','beforeend','üîí\x20¬°Evento\x20aleatorio:\x20','activation-section','history-map-today','save-geofence-btn','bloqueo','desc','floor','geofence-lng-input','geofence-radius-input','querySelector','play','HemisphereLight','velocidad','clear','<i\x20class=\x22bi\x20bi-exclamation-circle-fill\x20me-2\x20fs-5\x22></i>','return\x20(function()\x20','Conectado','add','warn','.geofence-list-new','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','getHours','\x20en\x20currentVehicleGeofences.','lastWaSent','exit','üì§\x20[WhatsApp]\x20Enviando:\x20\x22','debu','btn\x20btn-secondary\x20btn-lg\x20w-100\x20mt-2','bi-lock-fill\x20text-danger','maxSpeed','En\x20Zona\x20Segura','background','Motor\x20BLOQUEADO\x20remotamente','timestamp','toUpperCase','textContent','&copy;\x20OpenStreetMap','catch','yesterday','addEventListener','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22geofence-status-','getLatLng','[Header]\x20No\x20se\x20encontraron\x20los\x20botones\x20de\x20login/logout\x20en\x20el\x20header.','atan2','longitude','map','reverse','Crea\x20tu\x20primera\x20geocerca','run-demo-btn','Dentro','pings','follow-checkbox','style','¬°Alerta!\x20Ca√≠da\x20detectada\x20(','mensaje','\x20my-2\x22>','\x20---','<i\x20class=\x22bi\x20bi-geo-alt-fill\x20me-2\x20fs-5\x22></i>','‚úö\x20Agregar\x20veh√≠culo...','{}.constructor(\x22return\x20this\x22)(\x20)','value','toFixed','El\x20nombre\x20no\x20puede\x20estar\x20vac√≠o.','\x20km','\x22...','lockStatus','edit-name-btn','destroy','4wXAWSq','toLocaleTimeString','2243465TEfnyJ','[Comando]\x20Motor\x20cambiado\x20a:\x20','El\x20documento\x20/dispositivos/','scale','18452JeWALB','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','Nivel\x20M√≠nimo','add-new-vehicle','search','history-analysis-tab','flyTo','_name','gger','active','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x20p-3\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22d-flex\x20justify-content-between\x20align-items-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h6\x20class=\x22mb-0\x20geofence-name\x22>','block','20vpyBEK','Solo\x20puedes\x20tener\x20un\x20m√°ximo\x20de\x203\x20geocercas.','round','checked','Nombre\x20actualizado\x20con\x20√©xito.','0.5','bi-info-circle\x20text-secondary','trace','rotation','üîä\x20Audio\x20desbloqueado\x20correctamente.','speedDisplay','FBXLoader','./motorexp.fbx','Error:\x20','remove','change','\x20no\x20existe.','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-muted\x22\x20style=\x22font-size:\x200.75rem;\x22>','Movimiento\x20NO\x20autorizado.\x20Desplazamiento:\x20','[Dashboard]\x20Usuario\x20con\x20','Entrando\x20a\x20','friendlyName','geofence-select','https://api.callmebot.com/whatsapp.php?phone=','cancel-activation','Modal','danger','Error\x20al\x20guardar\x20el\x20nombre:','fall','https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png','geofenceModal','Error\x20al\x20actualizar\x20estado.','Sin\x20Ruta\x20Registrada\x20(','alert-toast\x20','safe','className','fitBounds','history-yesterday-tab','<div>','toISOString','max','PerspectiveCamera','div','batteryPercent','üÜò\x20CA√çDA\x20DETECTADA\x20(','bind','hide','bindPopup','</h5>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22history-map-','Alertas\x20de\x20WhatsApp\x20DESACTIVADAS','bi-unlock-fill\x20text-success','geofence-modal-success','cos','geofence-status-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x20shadow-sm\x20mt-3\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h6\x20class=\x22card-title\x22>Resumen\x20del\x20D√≠a</h6>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22card-text\x20mb-1\x22>Distancia:\x20','createElement','setRadius','uid','display','‚ö†Ô∏è\x20Ca√≠da\x20registrada','‚ö†Ô∏è\x20[WhatsApp]\x20Faltan\x20configurar\x20credenciales.','---\x20üß™\x20INICIANDO\x20DEMO\x20REALISTA\x20para\x20','data','addTo','today','history_days','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','vehicle-name-edit','position','dragend','Selecciona\x20un\x20veh√≠culo\x20primero.','#lockStatus\x20i','<b>','secondary','modal-map','62\x20km/h','bateria','dashboard-section','No\x20hay\x20un\x20veh√≠culo\x20seleccionado.','</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22badge\x20bg-','connection-dot\x20disconnected','exception','\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x20text-center\x20p-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small\x20class=\x22text-muted\x20fw-bold\x22>CONTROL</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22display-6\x20fw-bold\x20text-','[Geofence]\x20Guardando\x20en\x20Firebase:\x20/dispositivos/','setMinutes','panTo','openModalBtn','lat','bi-exclamation-triangle-fill\x20text-danger','history-map-yesterday','getMinutes','Desconectado','none','üîï\x20[WhatsApp]\x20Alerta\x20silenciada\x20por\x20el\x20usuario.','selectedIndex','</h6>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small\x20class=\x22text-muted\x22>Circular\x20-\x20','Audio\x20esperando\x20interacci√≥n\x20del\x20usuario.','duration','error','No\x20hay\x20una\x20geocerca\x20seleccionada\x20para\x20guardar.','El\x20radio\x20m√≠nimo\x20es\x20de\x2050\x20metros.','Error\x20al\x20guardar:\x20','reload','removeEventListener','üîí\x20Bloqueo','Nivel\x20de\x20Bater√≠a\x20(%)','Motor\x20Desbloqueado','click','primary','divIcon','pause','name','Motor\x20DESBLOQUEADO','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li\x20class=\x22list-group-item\x20d-flex\x20justify-content-between\x20align-items-center\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','random','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Por\x20favor,\x20selecciona\x20un\x20veh√≠culo\x20primero.','vehicle-name-input','option[value=\x22','flex','Error\x20al\x20cargar\x20datos\x20del\x20veh√≠culo\x20','No\x20se\x20encontr√≥\x20la\x20geocerca\x20','_active','dispositivos','cancel-name-btn','[Dashboard]\x20initDashboard\x20llamado\x20sin\x20un\x20usuario\x20autenticado.\x20Deteniendo.','_radius','Fuera','chain','history-content','Nueva\x20Geocerca','lon','load','Error\x20de\x20red.\x20Int√©ntalo\x20de\x20nuevo.','Error\x20cargando\x20an√°lisis:','Error\x20al\x20cambiar\x20bloqueo:','getBounds','function\x20*\x5c(\x20*\x5c)','setView','info','2-digit','[Firestore]\x20Escuchando\x20en\x20tiempo\x20real:\x20/dispositivos/','invalidateSize','button','bg-danger\x20bg-opacity-10','Error\x20al\x20inicializar\x20el\x20modal.\x20Faltan\x20elementos\x20del\x20DOM.','trim',')\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22bi\x20bi-eye\x22></i>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','getDate','‚úÖ\x20¬°C√≥digo\x20activado!\x20Plan\x20','vehicle-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-muted\x20small\x20px-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20No\x20hay\x20geocercas\x20configuradas.\x20Haz\x20clic\x20en\x20\x22Editar\x20/\x20Crear\x22\x20para\x20a√±adir\x20una.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>','join','WebGLRenderer','call','type','AmbientLight','undefined','\x20bg-opacity-10\x20text-','DESBLOQUEADO','928880uYZEjh','isInside','render','apply','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22small\x20text-muted\x20mt-1\x22>Carga\x20m√≠nima</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22row\x20g-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22col-lg-8\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x20h-100\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x20bg-white\x20py-3\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h6\x20class=\x22card-title\x20mb-0\x22><i\x20class=\x22bi\x20bi-graph-down\x22></i>\x20Tendencia\x20de\x20Bater√≠a\x20(√öltimas\x20Horas)</h6>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22height:\x20250px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<canvas\x20id=\x22batteryChart\x22></canvas>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22col-lg-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x20h-100\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x20bg-white\x20py-3\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h6\x20class=\x22mb-0\x22><i\x20class=\x22bi\x20bi-clock-history\x22></i>\x20Eventos\x20Recientes</h6>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20class=\x22list-group\x20list-group-flush\x22\x20style=\x22max-height:\x20280px;\x20overflow-y:\x20auto;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','log','sliderValue','Error\x20en\x20la\x20escucha\x20de\x20Firestore:','centerGeofence','oninput','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22small\x20text-muted\x20mt-1\x22>Ca√≠das\x20detectadas</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22col-md-3\x20col-6\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x20h-100\x20border-','historyMapYesterday','geofence-modal-error','polyline','shown.bs.tab','inside','lookAt','removeLayer','geofence-lat-input','</div>','warning','5217731999004','1686390Cnxjbi','status','‚ö†Ô∏è\x20Precauci√≥n:\x20Inclinaci√≥n\x20alta\x20(','[Firestore]\x20Timeout:\x20No\x20se\x20han\x20recibido\x20datos\x20en\x2010\x20segundos.','Riesgo','geo','Sin\x20datos','test','activation-code','toString','193944cJtSzg','onclick','docs','circle','<i\x20class=\x22bi\x20bi-check-circle-fill\x20me-2\x20fs-5\x22></i>','events','connection-dot\x20connected','opacity','stateObject','data:audio/mp3;base64,SUQzBAAAAAABAFRYWFgAAAASAAADbWFqb3JfYnJhbmQAZGFzaABUWFhYAAAAEQAAA21pbm9yX3ZlcnNpb24AMABUWFhYAAAAHAAAA2NvbXBhdGlibGVfYnJhbmRzAGlzbzZtcDQxAFRTU0UAAAAPAAADTGF2ZjU5LjI3LjEwMAAAAAAAAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAABDQVNNZTMuMTAwiuQAAAAAAFILAAALAAAAAAA//uQZAAABHAywAAAAAAAAM8AAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA//uQZAAAAAAAALAAAAAAAALAAAAAAAABAAABAAAAAAAAAAABAAAAAAAA','ubicacion','¬øIniciar\x20simulaci√≥n\x20de\x20ruta?\x20Esto\x20sobrescribir√°\x20el\x20historial\x20de\x20\x27Hoy\x27\x20para\x20este\x20veh√≠culo.','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22me-3\x20mt-1\x22><i\x20class=\x22bi\x20','then','constructor','tipo','lng','historyMapToday','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','while\x20(true)\x20{}','target','shown.bs.modal','card-lock-toggle','inclinacion','sin','length','Saliendo\x20de\x20','new-geofence-btn','Estado\x20alertas\x20WhatsApp:'];a4_0x1683=function(){return _0x256cb5;};return a4_0x1683();}function centerGeofence(_0x4af4dd){const _0x948a3c=a4_0x261970;if(currentVehicleGeofences&&currentVehicleGeofences[_0x4af4dd]){const _0x50f632=currentVehicleGeofences[_0x4af4dd];document[_0x948a3c(0x236)]('follow-checkbox')['checked']=![],followState=![],map[_0x948a3c(0x28d)]([_0x50f632[_0x948a3c(0x2ea)],_0x50f632[_0x948a3c(0x316)]],0x10);}else console[_0x948a3c(0x2f5)](_0x948a3c(0x30c)+_0x4af4dd+_0x948a3c(0x253));}window[a4_0x261970(0x1ab)]=centerGeofence;function parseGeofencesFromDoc(_0x168ac1){const _0x46a36d=a4_0x261970,_0x1e6d89=[];for(let _0x3124c2=0x1;_0x3124c2<=0x3;_0x3124c2++){const _0x37f359=_0x168ac1[_0x46a36d(0x1be)+_0x3124c2],_0x1b23e5=_0x168ac1[_0x46a36d(0x1be)+_0x3124c2+_0x46a36d(0x28e)],_0x5cd391=_0x168ac1['geo'+_0x3124c2+_0x46a36d(0x311)],_0x29b70e=_0x168ac1[_0x46a36d(0x1be)+_0x3124c2+_0x46a36d(0x30d)];_0x37f359&&_0x37f359[_0x46a36d(0x232)]&&_0x1b23e5&&_0x5cd391&&_0x1e6d89['push']({'id':_0x46a36d(0x1be)+_0x3124c2,'name':_0x1b23e5,'lat':_0x37f359[_0x46a36d(0x232)],'lon':_0x37f359['longitude'],'radius':_0x5cd391,'active':_0x29b70e||![],'isInside':![]});}return _0x1e6d89;}function checkGeofences(_0x5bff88,_0x5a1b3,_0x398149){const _0xff77c9=a4_0x261970,_0x246c56=currentVehicleGeofences;_0x398149[_0xff77c9(0x1e4)]((_0x1f6fcb,_0x4353de)=>{const _0x26a572=_0xff77c9;if(!_0x5bff88||!_0x5a1b3||!_0x1f6fcb[_0x26a572(0x290)]){_0x1f6fcb[_0x26a572(0x1a4)]=![],updateGeofenceUI(_0x4353de,![]);return;}const _0x3a5c37=getDistance(_0x5bff88,_0x5a1b3,_0x1f6fcb[_0x26a572(0x2ea)],_0x1f6fcb[_0x26a572(0x316)]),_0x341852=_0x246c56[_0x4353de]?_0x246c56[_0x4353de]['isInside']:![],_0x4c4d41=_0x3a5c37<=_0x1f6fcb[_0x26a572(0x22d)];if(_0x4c4d41&&!_0x341852)_0x1f6fcb[_0x26a572(0x1a4)]=!![],showAlert(_0x26a572(0x2a7)+_0x1f6fcb[_0x26a572(0x302)],_0x26a572(0x218));else!_0x4c4d41&&_0x341852?(_0x1f6fcb[_0x26a572(0x1a4)]=![],showAlert(_0x26a572(0x1dd)+_0x1f6fcb[_0x26a572(0x302)],_0x26a572(0x255))):_0x1f6fcb[_0x26a572(0x1a4)]=_0x341852;updateGeofenceUI(_0x4353de,_0x1f6fcb[_0x26a572(0x1a4)]);});}function updateGeofenceListUI(_0x3e4fde){const _0x48cb90=a4_0x261970,_0x3ccf12=document[_0x48cb90(0x246)](_0x48cb90(0x250));if(!_0x3ccf12)return;_0x3ccf12[_0x48cb90(0x23b)]='';if(!_0x3e4fde||_0x3e4fde['length']===0x0){_0x3ccf12[_0x48cb90(0x23b)]=_0x48cb90(0x19a);return;}_0x3e4fde[_0x48cb90(0x1e4)]((_0x3d8829,_0x414f0b)=>{const _0x35e154=_0x48cb90,_0x21a833=_0x3d8829[_0x35e154(0x1a4)]?'inside':'outside',_0x3fb236=_0x3d8829[_0x35e154(0x1a4)]?_0x35e154(0x26e):_0x35e154(0x312),_0x203042=_0x3d8829[_0x35e154(0x290)]?'checked':'',_0x563bd2=_0x35e154(0x1f0)+_0x414f0b+_0x35e154(0x291)+_0x3d8829[_0x35e154(0x302)]+_0x35e154(0x2f2)+_0x3d8829[_0x35e154(0x22d)]+'m</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-check\x20form-switch\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20class=\x22form-check-input\x22\x20type=\x22checkbox\x22\x20role=\x22switch\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id=\x22geofence-toggle-'+_0x414f0b+'\x22\x20'+_0x203042+_0x35e154(0x265)+_0x414f0b+'\x22\x20class=\x22geofence-status\x20'+_0x21a833+_0x35e154(0x1d5)+_0x3fb236+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22btn\x20btn-sm\x20btn-outline-secondary\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20onclick=\x22window.centerGeofence('+_0x414f0b+_0x35e154(0x196);_0x3ccf12[_0x35e154(0x21e)](_0x35e154(0x23c),_0x563bd2);});}function getDistance(_0x1b0877,_0x49648c,_0x34a0b7,_0x1364cf){const _0x168a74=a4_0x261970,_0x243402=0x6136b8,_0x5aa5cc=_0x1b0877*Math['PI']/0xb4,_0x4d7c8a=_0x34a0b7*Math['PI']/0xb4,_0x2ccd1f=(_0x34a0b7-_0x1b0877)*Math['PI']/0xb4,_0x3abb1e=(_0x1364cf-_0x49648c)*Math['PI']/0xb4,_0xe790d=Math[_0x168a74(0x1db)](_0x2ccd1f/0x2)*Math[_0x168a74(0x1db)](_0x2ccd1f/0x2)+Math['cos'](_0x5aa5cc)*Math[_0x168a74(0x2c7)](_0x4d7c8a)*Math[_0x168a74(0x1db)](_0x3abb1e/0x2)*Math[_0x168a74(0x1db)](_0x3abb1e/0x2);return _0x243402*0x2*Math[_0x168a74(0x268)](Math['sqrt'](_0xe790d),Math['sqrt'](0x1-_0xe790d));}function drawGeofencesOnMap(_0x169272){const _0x5b280f=a4_0x261970;if(!map)return;geofenceLayers[_0x5b280f(0x1e4)](_0x8308a3=>map[_0x5b280f(0x1b4)](_0x8308a3)),geofenceLayers=[];if(!_0x169272)return;_0x169272['forEach'](_0x1c6833=>{const _0x455336=_0x5b280f;if(!_0x1c6833['active'])return;const _0x101c98=L[_0x455336(0x1c6)]([_0x1c6833[_0x455336(0x2ea)],_0x1c6833[_0x455336(0x316)]],{'color':_0x455336(0x1e0),'fillColor':_0x455336(0x1e0),'fillOpacity':0.2,'radius':_0x1c6833[_0x455336(0x22d)]})['addTo'](map);geofenceLayers[_0x455336(0x1ee)](_0x101c98);});}function updateGeofenceUI(_0x1a9a80,_0x1476c7){const _0x1a17af=a4_0x261970,_0x1e523b=document['getElementById'](_0x1a17af(0x2c8)+_0x1a9a80);_0x1e523b&&(_0x1e523b[_0x1a17af(0x260)]=_0x1476c7?'Dentro':_0x1a17af(0x312),_0x1e523b[_0x1a17af(0x2b6)]=_0x1a17af(0x21f)+(_0x1476c7?_0x1a17af(0x1b2):'outside'));}function setupModal(){const _0x5ab40a=a4_0x261970,_0x815dd5=document[_0x5ab40a(0x236)](_0x5ab40a(0x2b1)),_0x330367=document[_0x5ab40a(0x236)](_0x5ab40a(0x2e9)),_0x4f87ea=document[_0x5ab40a(0x236)](_0x5ab40a(0x240)),_0xe1f8d6=document['getElementById'](_0x5ab40a(0x1de)),_0x498dd6=document[_0x5ab40a(0x236)]('geofence-select'),_0x4b46ed=document[_0x5ab40a(0x236)](_0x5ab40a(0x245)),_0xab2684=document[_0x5ab40a(0x236)]('geofence-lat-input'),_0xb39a49=document[_0x5ab40a(0x236)](_0x5ab40a(0x244));if(!_0x815dd5||!_0x330367||!_0x4f87ea||!_0xe1f8d6||!_0x498dd6||!_0x4b46ed||!_0xab2684||!_0xb39a49){console[_0x5ab40a(0x2f5)](_0x5ab40a(0x194));return;}geofenceModalInstance=new bootstrap[(_0x5ab40a(0x2ac))](_0x815dd5),_0x330367['onclick']=()=>{geofenceModalInstance['show']();},_0x815dd5['addEventListener'](_0x5ab40a(0x1d8),()=>{const _0x44dd2b=_0x5ab40a;initModalMap(),loadGeofencesInModal(currentVehicleGeofences);const _0xbb33c6=document[_0x44dd2b(0x236)](_0x44dd2b(0x2a9))['value'];_0xbb33c6&&loadGeofenceInModalEditor(Number(_0xbb33c6));}),_0x498dd6[_0x5ab40a(0x20d)]=_0x5a89dd=>loadGeofenceInModalEditor(Number(_0x5a89dd['target'][_0x5ab40a(0x279)])),_0xe1f8d6[_0x5ab40a(0x1c4)]=handleNewGeofence,_0x4f87ea['onclick']=handleSaveGeofence,_0x4b46ed[_0x5ab40a(0x1ac)]=_0x21cf3e=>{const _0x2c299a=_0x5ab40a;activeEditingGeofence['circle']&&activeEditingGeofence[_0x2c299a(0x1c6)][_0x2c299a(0x2cb)](Number(_0x21cf3e['target'][_0x2c299a(0x279)])||0x0);},_0xab2684[_0x5ab40a(0x1ac)]=updateModalMarkerFromInputs,_0xb39a49[_0x5ab40a(0x1ac)]=updateModalMarkerFromInputs;}function initModalMap(){const _0x4a2b11=a4_0x261970;if(modalMap){modalMap[_0x4a2b11(0x191)]();return;}const _0x2ea92e=[19.4326,-99.1332];modalMap=L[_0x4a2b11(0x26a)](_0x4a2b11(0x2dd))['setView'](_0x2ea92e,0xe),L[_0x4a2b11(0x200)](_0x4a2b11(0x2b0))[_0x4a2b11(0x2d2)](modalMap);}function loadGeofencesInModal(_0x4c26b4){const _0x14680f=a4_0x261970,_0x1ad7fd=document[_0x14680f(0x236)](_0x14680f(0x2a9)),_0x385502=document[_0x14680f(0x236)]('new-geofence-btn');_0x1ad7fd[_0x14680f(0x23b)]='',_0x4c26b4&&_0x4c26b4[_0x14680f(0x1dc)]>0x0?(_0x4c26b4[_0x14680f(0x1e4)]((_0xc14081,_0x1b4be7)=>{const _0x38c675=_0x14680f;_0x1ad7fd['appendChild'](new Option(_0xc14081[_0x38c675(0x302)],_0x1b4be7));}),loadGeofenceInModalEditor(0x0),_0x1ad7fd[_0x14680f(0x1e6)]=![]):(_0x1ad7fd['appendChild'](new Option(_0x14680f(0x26c),-0x1)),_0x1ad7fd[_0x14680f(0x1e6)]=!![],handleNewGeofence()),_0x385502[_0x14680f(0x1e6)]=_0x4c26b4[_0x14680f(0x1dc)]>=0x3;}function handleNewGeofence(){const _0x3e3c17=a4_0x261970,_0x1bc34d=currentVehicleGeofences['map'](_0x571ab8=>_0x571ab8['id']);let _0x1a7017=null;for(let _0x4e8d20=0x1;_0x4e8d20<=0x3;_0x4e8d20++){if(!_0x1bc34d[_0x3e3c17(0x1f4)](_0x3e3c17(0x1be)+_0x4e8d20)){_0x1a7017=_0x3e3c17(0x1be)+_0x4e8d20;break;}}if(!_0x1a7017){showGeofenceModalAlert(_0x3e3c17(0x2f5),_0x3e3c17(0x294));return;}console['log']('[Geofence]\x20Creando\x20nueva\x20geocerca\x20en\x20el\x20slot:\x20'+_0x1a7017),activeEditingGeofenceSlot=_0x1a7017;if(activeEditingGeofence['marker'])modalMap[_0x3e3c17(0x1b4)](activeEditingGeofence[_0x3e3c17(0x22a)]);if(activeEditingGeofence[_0x3e3c17(0x1c6)])modalMap[_0x3e3c17(0x1b4)](activeEditingGeofence['circle']);const _0x321639=document[_0x3e3c17(0x236)]('geofence-name-input'),_0x5ba0fb=document[_0x3e3c17(0x236)](_0x3e3c17(0x245)),_0x5eb459=document[_0x3e3c17(0x236)](_0x3e3c17(0x1b5)),_0x3d66b6=document['getElementById'](_0x3e3c17(0x244));document['getElementById']('geofence-select')[_0x3e3c17(0x1e6)]=!![],_0x321639[_0x3e3c17(0x279)]=_0x3e3c17(0x315),_0x5ba0fb[_0x3e3c17(0x279)]=0x64;const _0x5d5561=modalMap['getCenter']();_0x5eb459[_0x3e3c17(0x279)]=_0x5d5561[_0x3e3c17(0x2ea)]['toFixed'](0x6),_0x3d66b6[_0x3e3c17(0x279)]=_0x5d5561[_0x3e3c17(0x1d3)]['toFixed'](0x6),activeEditingGeofence['circle']=L[_0x3e3c17(0x1c6)](_0x5d5561,{'radius':0x64})[_0x3e3c17(0x2d2)](modalMap),activeEditingGeofence[_0x3e3c17(0x22a)]=L['marker'](_0x5d5561,{'draggable':!![]})[_0x3e3c17(0x2d2)](modalMap),activeEditingGeofence['marker']['on'](_0x3e3c17(0x2d8),_0x2794f4=>{const _0x2ccb55=_0x3e3c17,{lat:_0x516e7d,lng:_0x18b5ad}=_0x2794f4['target'][_0x2ccb55(0x266)]();activeEditingGeofence['circle'][_0x2ccb55(0x206)]([_0x516e7d,_0x18b5ad]),_0x5eb459['value']=_0x516e7d[_0x2ccb55(0x27a)](0x6),_0x3d66b6[_0x2ccb55(0x279)]=_0x18b5ad[_0x2ccb55(0x27a)](0x6);});}function loadGeofenceInModalEditor(_0x458065){const _0x4faf47=a4_0x261970;if(!modalMap)return;const _0x143cf7=document[_0x4faf47(0x236)]('geofence-name-input'),_0x4f4354=document['getElementById'](_0x4faf47(0x245)),_0xf3a9a0=document[_0x4faf47(0x236)](_0x4faf47(0x1b5)),_0x25e998=document[_0x4faf47(0x236)](_0x4faf47(0x244));if(activeEditingGeofence[_0x4faf47(0x22a)])modalMap[_0x4faf47(0x1b4)](activeEditingGeofence['marker']);if(activeEditingGeofence[_0x4faf47(0x1c6)])modalMap[_0x4faf47(0x1b4)](activeEditingGeofence['circle']);activeEditingGeofence[_0x4faf47(0x22a)]=null,activeEditingGeofence[_0x4faf47(0x1c6)]=null;if(_0x458065===-0x1){_0x143cf7[_0x4faf47(0x279)]='',_0x4f4354['value']=0x64,_0xf3a9a0['value']='',_0x25e998[_0x4faf47(0x279)]='',activeEditingGeofenceSlot=null;return;}const _0x417c2e=currentVehicleGeofences[_0x458065];if(!_0x417c2e)return;activeEditingGeofenceSlot=_0x417c2e['id'],document[_0x4faf47(0x236)](_0x4faf47(0x2a9))[_0x4faf47(0x279)]=_0x458065,_0x143cf7['value']=_0x417c2e[_0x4faf47(0x302)],_0x4f4354[_0x4faf47(0x279)]=_0x417c2e[_0x4faf47(0x22d)],_0xf3a9a0[_0x4faf47(0x279)]=_0x417c2e[_0x4faf47(0x2ea)],_0x25e998['value']=_0x417c2e[_0x4faf47(0x316)];const _0x3795f8=[_0x417c2e[_0x4faf47(0x2ea)],_0x417c2e[_0x4faf47(0x316)]];activeEditingGeofence[_0x4faf47(0x1c6)]=L[_0x4faf47(0x1c6)](_0x3795f8,{'radius':_0x417c2e[_0x4faf47(0x22d)]})[_0x4faf47(0x2d2)](modalMap),activeEditingGeofence[_0x4faf47(0x22a)]=L[_0x4faf47(0x22a)](_0x3795f8,{'draggable':!![]})['addTo'](modalMap),modalMap['setView'](_0x3795f8,0x10),activeEditingGeofence[_0x4faf47(0x22a)]['on'](_0x4faf47(0x2d8),_0x502ba5=>{const _0x10bcab=_0x4faf47,{lat:_0x125bd0,lng:_0x43fdc4}=_0x502ba5['target']['getLatLng']();activeEditingGeofence[_0x10bcab(0x1c6)][_0x10bcab(0x206)]([_0x125bd0,_0x43fdc4]),_0xf3a9a0['value']=_0x125bd0[_0x10bcab(0x27a)](0x6),_0x25e998[_0x10bcab(0x279)]=_0x43fdc4[_0x10bcab(0x27a)](0x6);});}const audioBase64=a4_0x261970(0x1cc),notificationSound=new Audio(audioBase64);notificationSound['volume']=0.6;function showAlert(_0x3e23c7,_0x455c59){const _0x19f9a7=a4_0x261970,_0x73bd1d=document['getElementById'](_0x19f9a7(0x237));if(!_0x73bd1d)return;typeof notificationSound!==_0x19f9a7(0x1a0)&&(notificationSound['currentTime']=0x0,notificationSound[_0x19f9a7(0x247)]()[_0x19f9a7(0x262)](_0x246205=>{const _0x43d462=_0x19f9a7;console[_0x43d462(0x1a8)](_0x43d462(0x2f3));}));const _0x38fa1a=document[_0x19f9a7(0x2ca)](_0x19f9a7(0x2bd));_0x38fa1a[_0x19f9a7(0x2b6)]=_0x19f9a7(0x2b4)+_0x455c59;let _0x1ecf87='';if(_0x455c59===_0x19f9a7(0x2f5))_0x1ecf87=_0x19f9a7(0x24b);else{if(_0x455c59===_0x19f9a7(0x213))_0x1ecf87=_0x19f9a7(0x1c7);else{if(_0x455c59===_0x19f9a7(0x1b7))_0x1ecf87='<i\x20class=\x22bi\x20bi-exclamation-triangle-fill\x20me-2\x20fs-5\x22></i>';else{if(_0x455c59===_0x19f9a7(0x218))_0x1ecf87=_0x19f9a7(0x276);else _0x455c59===_0x19f9a7(0x255)&&(_0x1ecf87='<i\x20class=\x22bi\x20bi-box-arrow-right\x20me-2\x20fs-5\x22></i>');}}}_0x38fa1a[_0x19f9a7(0x23b)]=_0x1ecf87+_0x19f9a7(0x2b9)+_0x3e23c7+'</div>',_0x73bd1d['appendChild'](_0x38fa1a),setTimeout(()=>_0x38fa1a['classList'][_0x19f9a7(0x24e)]('show'),0xa),setTimeout(()=>{const _0x3213c7=_0x19f9a7;_0x38fa1a[_0x3213c7(0x205)][_0x3213c7(0x2a1)](_0x3213c7(0x1e2)),_0x38fa1a[_0x3213c7(0x264)](_0x3213c7(0x1f9),()=>_0x38fa1a[_0x3213c7(0x2a1)]());},0x1388);}function clearHistoryUI(){const _0x374d87=a4_0x261970,_0x27d816=document[_0x374d87(0x236)](_0x374d87(0x314));_0x27d816&&(_0x27d816[_0x374d87(0x23b)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x20py-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-muted\x22>Cargando\x20historial...</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'),historyMapToday&&(historyMapToday[_0x374d87(0x2a1)](),historyMapToday=null),historyMapYesterday&&(historyMapYesterday['remove'](),historyMapYesterday=null);}function getFormattedDate(_0x4f693e){const _0x472bf8=a4_0x261970;return _0x4f693e[_0x472bf8(0x2ba)]()['split']('T')[0x0];}function createEmptyHistoryDay(_0xcb2775){const _0x33cf2b=a4_0x261970;return{'summary':{'title':_0x33cf2b(0x2b3)+_0xcb2775+')','distance':_0x33cf2b(0x20e),'maxSpeed':_0x33cf2b(0x1f2)},'routePoints':[]};}async function loadVehicleHistory(_0x4ab4d4){const _0x20e0d4=a4_0x261970,_0x19de09=new Date(),_0x169da9=new Date(_0x19de09);_0x169da9[_0x20e0d4(0x235)](_0x169da9[_0x20e0d4(0x197)]()-0x1);const _0x5eda99=getFormattedDate(_0x19de09),_0x14403f=getFormattedDate(_0x169da9);try{const _0x5a72bb=doc(db,_0x20e0d4(0x30e),_0x4ab4d4,_0x20e0d4(0x2d4),_0x5eda99),_0x429cc9=doc(db,_0x20e0d4(0x30e),_0x4ab4d4,_0x20e0d4(0x2d4),_0x14403f),[_0x446b14,_0x55b647]=await Promise[_0x20e0d4(0x20a)]([getDoc(_0x5a72bb),getDoc(_0x429cc9)]),_0x985667={'today':_0x446b14[_0x20e0d4(0x1ec)]()?_0x446b14[_0x20e0d4(0x2d1)]():createEmptyHistoryDay(_0x20e0d4(0x1eb)),'yesterday':_0x55b647['exists']()?_0x55b647[_0x20e0d4(0x2d1)]():createEmptyHistoryDay('Ayer')};updateHistoryTabs(_0x985667);}catch(_0x4d5b6e){console['error'](_0x20e0d4(0x20f),_0x4d5b6e),document[_0x20e0d4(0x236)](_0x20e0d4(0x314))['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x20py-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text-danger\x22>No\x20se\x20pudo\x20cargar\x20el\x20historial.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small\x20class=\x22text-muted\x22>'+_0x4d5b6e[_0x20e0d4(0x1fc)]+'</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}function updateHistoryTabs(_0x1752a9){const _0x3343e0=a4_0x261970,_0xdf3bde=document[_0x3343e0(0x236)](_0x3343e0(0x314));if(!_0xdf3bde)return;batteryChartInstance&&(batteryChartInstance[_0x3343e0(0x280)](),batteryChartInstance=null);_0xdf3bde['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22container\x20py-4\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul\x20class=\x22nav\x20nav-pills\x20mb-3\x22\x20id=\x22history-day-tab\x22\x20role=\x22tablist\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li\x20class=\x22nav-item\x22\x20role=\x22presentation\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nav-link\x20active\x22\x20id=\x22history-today-tab\x22\x20data-bs-toggle=\x22pill\x22\x20data-bs-target=\x22#history-today-pane\x22\x20type=\x22button\x22\x20role=\x22tab\x22>Hoy</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li\x20class=\x22nav-item\x22\x20role=\x22presentation\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nav-link\x22\x20id=\x22history-yesterday-tab\x22\x20data-bs-toggle=\x22pill\x22\x20data-bs-target=\x22#history-yesterday-pane\x22\x20type=\x22button\x22\x20role=\x22tab\x22>Ayer</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li\x20class=\x22nav-item\x22\x20role=\x22presentation\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nav-link\x22\x20id=\x22history-analysis-tab\x22\x20data-bs-toggle=\x22pill\x22\x20data-bs-target=\x22#history-analysis-pane\x22\x20type=\x22button\x22\x20role=\x22tab\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<i\x20class=\x22bi\x20bi-bar-chart-line\x22></i>\x20An√°lisis\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</ul>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tab-content\x22\x20id=\x22history-day-tabContent\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tab-pane\x20fade\x20show\x20active\x22\x20id=\x22history-today-pane\x22\x20role=\x22tabpanel\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tab-pane\x20fade\x22\x20id=\x22history-yesterday-pane\x22\x20role=\x22tabpanel\x22></div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22tab-pane\x20fade\x22\x20id=\x22history-analysis-pane\x22\x20role=\x22tabpanel\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22text-center\x20py-5\x22><div\x20class=\x22spinner-border\x20text-primary\x22></div><p>Cargando\x20datos\x20de\x20sensores...</p></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';const _0x3f2ac7=document[_0x3343e0(0x236)](_0x3343e0(0x211)),_0xeb4096=document[_0x3343e0(0x236)](_0x3343e0(0x22b));_0x3f2ac7[_0x3343e0(0x23b)]=generateHistoryPaneHTML(_0x3343e0(0x2d3),_0x1752a9[_0x3343e0(0x2d3)]),_0xeb4096['innerHTML']=generateHistoryPaneHTML(_0x3343e0(0x263),_0x1752a9[_0x3343e0(0x263)]),initHistoryMap(_0x3343e0(0x23f),_0x1752a9[_0x3343e0(0x2d3)]['routePoints'],_0x3343e0(0x1d4));const _0xa886c2=document[_0x3343e0(0x236)](_0x3343e0(0x2b8));_0xa886c2&&_0xa886c2[_0x3343e0(0x264)](_0x3343e0(0x1b1),()=>{const _0x235cea=_0x3343e0;initHistoryMap(_0x235cea(0x2ec),_0x1752a9[_0x235cea(0x263)]['routePoints'],'historyMapYesterday');},{'once':!![]});const _0x305f53=document['getElementById'](_0x3343e0(0x28c));_0x305f53&&_0x305f53[_0x3343e0(0x264)](_0x3343e0(0x1b1),()=>{loadAnalysisData(currentVehicleId);});}function generateHistoryPaneHTML(_0xe33e70,_0x560eeb){const _0x1137a8=a4_0x261970;let _0x3b221d='';_0x560eeb[_0x1137a8(0x210)]&&_0x560eeb[_0x1137a8(0x210)][_0x1137a8(0x1dc)]>0x0?_0x3b221d=_0x560eeb[_0x1137a8(0x210)][_0x1137a8(0x26a)](_0x3971cb=>_0x1137a8(0x304)+_0x3971cb[_0x1137a8(0x302)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22badge\x20bg-primary\x20rounded-pill\x22>'+_0x3971cb[_0x1137a8(0x2f4)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</li>\x0a\x20\x20\x20\x20\x20\x20\x20\x20')[_0x1137a8(0x19b)](''):_0x3b221d=_0x1137a8(0x1fa);const _0x466f4c=document[_0x1137a8(0x236)]('vehicle-select'),_0x4961b9=_0x466f4c['options'][_0x466f4c[_0x1137a8(0x2f1)]][_0x1137a8(0x234)],_0x48c9fb=_0xe33e70===_0x1137a8(0x2d3)?'Ruta\x20de\x20Hoy:\x20'+_0x4961b9:'Ruta\x20de\x20Ayer:\x20'+_0x4961b9;return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22col-lg-7\x20mb-3\x20mb-lg-0\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h5\x20class=\x22mb-3\x22>'+_0x48c9fb+_0x1137a8(0x2c3)+_0xe33e70+'\x22\x20class=\x22bg-light\x20border\x20rounded\x22\x20style=\x22min-height:\x20400px;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x560eeb[_0x1137a8(0x210)][_0x1137a8(0x1dc)]===0x0?'<div\x20class=\x22p-3\x20text-muted\x22>No\x20hay\x20ruta\x20para\x20mostrar.</div>':'')+_0x1137a8(0x201)+_0x3b221d+_0x1137a8(0x2c9)+_0x560eeb[_0x1137a8(0x221)][_0x1137a8(0x23a)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22card-text\x20mb-0\x22>Velocidad\x20M√°x:\x20'+_0x560eeb[_0x1137a8(0x221)][_0x1137a8(0x25a)]+_0x1137a8(0x251);}function initHistoryMap(_0x2dc1dc,_0xf534f5,_0x3a7e0c){const _0x70165d=a4_0x261970;if(!_0xf534f5||_0xf534f5[_0x70165d(0x1dc)]===0x0){console[_0x70165d(0x1a8)]('[History]\x20No\x20hay\x20puntos\x20de\x20ruta\x20para\x20el\x20mapa\x20'+_0x2dc1dc+'.');return;}if(_0x3a7e0c===_0x70165d(0x1d4)&&historyMapToday){setTimeout(()=>{const _0x425fcd=_0x70165d;historyMapToday[_0x425fcd(0x191)]();const _0x328707=_0xf534f5['map'](_0x3cc525=>[_0x3cc525[_0x425fcd(0x2ea)],_0x3cc525[_0x425fcd(0x1d3)]]);historyMapToday['fitBounds'](L['polyline'](_0x328707)[_0x425fcd(0x31b)](),{'padding':[0x32,0x32]});},0x12c);return;}if(_0x3a7e0c===_0x70165d(0x1ae)&&historyMapYesterday){setTimeout(()=>{const _0x5052cc=_0x70165d;historyMapYesterday[_0x5052cc(0x191)]();const _0x2d7a46=_0xf534f5[_0x5052cc(0x26a)](_0xf07a1=>[_0xf07a1['lat'],_0xf07a1[_0x5052cc(0x1d3)]]);historyMapYesterday['fitBounds'](L['polyline'](_0x2d7a46)[_0x5052cc(0x31b)](),{'padding':[0x32,0x32]});},0x12c);return;}try{const _0x944902=L[_0x70165d(0x26a)](_0x2dc1dc);L[_0x70165d(0x200)]('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{'attribution':_0x70165d(0x261)})['addTo'](_0x944902);const _0x227faf=_0xf534f5['map'](_0x166108=>[_0x166108[_0x70165d(0x2ea)],_0x166108[_0x70165d(0x1d3)]]),_0x1c5dc7=L[_0x70165d(0x1b0)](_0x227faf,{'color':'#2563eb','weight':0x4})[_0x70165d(0x2d2)](_0x944902);_0xf534f5[_0x70165d(0x1e4)]((_0x4eb020,_0x1fae43)=>{const _0x5a5f21=_0x70165d;(_0x1fae43===0x0||_0x1fae43===_0xf534f5[_0x5a5f21(0x1dc)]-0x1||_0x4eb020[_0x5a5f21(0x302)][_0x5a5f21(0x1f4)]('‚ö†Ô∏è')||_0x4eb020[_0x5a5f21(0x302)][_0x5a5f21(0x1f4)]('Bloqueo'))&&L[_0x5a5f21(0x22a)]([_0x4eb020[_0x5a5f21(0x2ea)],_0x4eb020[_0x5a5f21(0x1d3)]])[_0x5a5f21(0x2d2)](_0x944902)[_0x5a5f21(0x2c2)](_0x5a5f21(0x2db)+_0x4eb020[_0x5a5f21(0x302)]+_0x5a5f21(0x1e8)+_0x4eb020[_0x5a5f21(0x2f4)]);});if(_0x3a7e0c==='historyMapToday')historyMapToday=_0x944902;else _0x3a7e0c===_0x70165d(0x1ae)&&(historyMapYesterday=_0x944902);setTimeout(()=>{const _0x437fc2=_0x70165d;_0x944902[_0x437fc2(0x191)](),_0x944902[_0x437fc2(0x2b7)](_0x1c5dc7[_0x437fc2(0x31b)](),{'padding':[0x32,0x32],'maxZoom':0x10,'animate':!![]});},0x12c);}catch(_0x1e9956){console[_0x70165d(0x2f5)]('Error\x20inicializando\x20el\x20mapa\x20'+_0x2dc1dc+':',_0x1e9956);}}async function handleSaveGeofence(){const _0x56d298=a4_0x261970;showGeofenceModalAlert(_0x56d298(0x24a),'');if(!currentVehicleId)return showGeofenceModalAlert('error',_0x56d298(0x2e1));if(!activeEditingGeofenceSlot)return showGeofenceModalAlert(_0x56d298(0x2f5),_0x56d298(0x2f6));const _0x16b62e=Number(document['getElementById'](_0x56d298(0x1b5))[_0x56d298(0x279)]),_0x284eae=Number(document[_0x56d298(0x236)](_0x56d298(0x244))[_0x56d298(0x279)]),_0x489bf6=document[_0x56d298(0x236)](_0x56d298(0x1fb))[_0x56d298(0x279)],_0x1407b5=Number(document[_0x56d298(0x236)]('geofence-radius-input')[_0x56d298(0x279)]),_0x548712=activeEditingGeofenceSlot;if(!_0x16b62e||!_0x284eae||_0x16b62e<-0x5a||_0x16b62e>0x5a||_0x284eae<-0xb4||_0x284eae>0xb4)return showGeofenceModalAlert(_0x56d298(0x2f5),_0x56d298(0x222));if(!_0x489bf6)return showGeofenceModalAlert(_0x56d298(0x2f5),'El\x20nombre\x20no\x20puede\x20estar\x20vac√≠o.');if(_0x1407b5<0x32)return showGeofenceModalAlert('error',_0x56d298(0x2f7));const _0x2ee044={[_0x548712]:new GeoPoint(_0x16b62e,_0x284eae),[_0x548712+_0x56d298(0x28e)]:_0x489bf6,[_0x548712+_0x56d298(0x311)]:_0x1407b5,[_0x548712+_0x56d298(0x30d)]:!![]};console[_0x56d298(0x1a8)](_0x56d298(0x2e6)+currentVehicleId,_0x2ee044);try{const _0x356fcd=doc(db,_0x56d298(0x30e),currentVehicleId);await updateDoc(_0x356fcd,_0x2ee044),showGeofenceModalAlert(_0x56d298(0x213),'Geocerca\x20guardada\x20con\x20√©xito.'),setTimeout(()=>{const _0x3ef8c4=_0x56d298;geofenceModalInstance[_0x3ef8c4(0x2c1)]();},0x3e8);}catch(_0x5c60af){console[_0x56d298(0x2f5)]('Error\x20al\x20guardar\x20geocerca:',_0x5c60af),showGeofenceModalAlert('error','Error\x20al\x20guardar:\x20'+_0x5c60af[_0x56d298(0x1fc)]);}}function updateModalMarkerFromInputs(){const _0x506f5b=a4_0x261970,_0x6b29ee=Number(document[_0x506f5b(0x236)](_0x506f5b(0x1b5))[_0x506f5b(0x279)]),_0x182239=Number(document['getElementById']('geofence-lng-input')[_0x506f5b(0x279)]);if(_0x6b29ee>=-0x5a&&_0x6b29ee<=0x5a&&_0x182239>=-0xb4&&_0x182239<=0xb4){const _0x51af29=[_0x6b29ee,_0x182239];activeEditingGeofence[_0x506f5b(0x22a)]&&(activeEditingGeofence['marker']['setLatLng'](_0x51af29),activeEditingGeofence[_0x506f5b(0x1c6)][_0x506f5b(0x206)](_0x51af29),modalMap[_0x506f5b(0x2e8)](_0x51af29));}}function showGeofenceModalAlert(_0x128f23,_0x3c3229){const _0x306e07=a4_0x261970,_0x9875b9=document[_0x306e07(0x236)](_0x306e07(0x1af)),_0x4746f1=document['getElementById'](_0x306e07(0x2c6));_0x9875b9['style'][_0x306e07(0x2cd)]=_0x306e07(0x2ef),_0x4746f1[_0x306e07(0x271)][_0x306e07(0x2cd)]=_0x306e07(0x2ef);if(_0x128f23==='error')_0x9875b9['textContent']=_0x3c3229,_0x9875b9[_0x306e07(0x271)]['display']=_0x306e07(0x292);else _0x128f23===_0x306e07(0x213)&&(_0x4746f1[_0x306e07(0x260)]=_0x3c3229,_0x4746f1[_0x306e07(0x271)][_0x306e07(0x2cd)]='block');}function toggleVehicleNameEdit(_0x483541){const _0x3f5fa2=a4_0x261970,_0x23ae96=document[_0x3f5fa2(0x236)](_0x3f5fa2(0x22f)),_0x51dd82=document[_0x3f5fa2(0x236)](_0x3f5fa2(0x2d6)),_0x2a6ba5=document[_0x3f5fa2(0x236)](_0x3f5fa2(0x308)),_0x3c3f1a=document[_0x3f5fa2(0x236)](_0x3f5fa2(0x215));if(!_0x23ae96||!_0x51dd82||!_0x2a6ba5||!_0x3c3f1a)return;_0x483541?(_0x23ae96[_0x3f5fa2(0x271)][_0x3f5fa2(0x2cd)]=_0x3f5fa2(0x2ef),_0x51dd82[_0x3f5fa2(0x271)][_0x3f5fa2(0x2cd)]=_0x3f5fa2(0x30a),_0x2a6ba5['value']=_0x3c3f1a[_0x3f5fa2(0x260)],_0x2a6ba5['focus']()):(_0x23ae96[_0x3f5fa2(0x271)][_0x3f5fa2(0x2cd)]=_0x3f5fa2(0x30a),_0x51dd82[_0x3f5fa2(0x271)]['display']=_0x3f5fa2(0x2ef));}async function handleSaveVehicleName(){const _0x17d693=a4_0x261970,_0x47c462=document['getElementById']('vehicle-name-input'),_0x5828a3=_0x47c462['value'][_0x17d693(0x195)]();if(!_0x5828a3)return showAlert(_0x17d693(0x27b),_0x17d693(0x2f5));if(!currentVehicleId)return showAlert(_0x17d693(0x2e1),_0x17d693(0x2f5));try{const _0x3e0d83=doc(db,_0x17d693(0x30e),currentVehicleId);await updateDoc(_0x3e0d83,{'friendlyName':_0x5828a3}),updateVehicleNameInDropdown(currentVehicleId,_0x5828a3);const _0x4acadf=document[_0x17d693(0x236)](_0x17d693(0x215));if(_0x4acadf)_0x4acadf[_0x17d693(0x260)]=_0x5828a3;toggleVehicleNameEdit(![]),showAlert(_0x17d693(0x297),'success');}catch(_0x1064e4){console[_0x17d693(0x2f5)](_0x17d693(0x2ae),_0x1064e4),showAlert(_0x17d693(0x2f8)+_0x1064e4['message'],_0x17d693(0x2f5));}}function updateVehicleNameInDropdown(_0x2eae1c,_0x3f9671){const _0xa8df5c=a4_0x261970,_0x2c5c2c=document[_0xa8df5c(0x236)]('vehicle-select');if(!_0x2c5c2c)return;const _0xb38b5a=_0x2c5c2c['querySelector'](_0xa8df5c(0x309)+_0x2eae1c+'\x22]');if(_0xb38b5a)_0xb38b5a['textContent']=_0x3f9671;}function sleep(_0x1c6fa2){return new Promise(_0x1ed943=>setTimeout(_0x1ed943,_0x1c6fa2));}async function runDemoRoute(){const _0x168dd3=a4_0x261970,_0x52204b=document[_0x168dd3(0x236)](_0x168dd3(0x26d));if(!currentVehicleId){showAlert(_0x168dd3(0x307),_0x168dd3(0x2f5));return;}if(_0x52204b)_0x52204b['disabled']=!![];console[_0x168dd3(0x1a8)](_0x168dd3(0x2d0)+currentVehicleId+_0x168dd3(0x275));const _0x35ff61=[[-99.22082,20.20428],[-99.22073,20.20485],[-99.2206,20.20528],[-99.22051,20.20567],[-99.22051,20.20567],[-99.2204,20.20572],[-99.22023,20.20579],[-99.22018,20.20581],[-99.22011,20.20581],[-99.22002,20.2058],[-99.22002,20.2058],[-99.21988,20.20577],[-99.21969,20.20653],[-99.2194,20.20795],[-99.21914,20.20942],[-99.21914,20.20942],[-99.21792,20.21632],[-99.21767,20.21779],[-99.21755,20.2184],[-99.21716,20.22032],[-99.2171,20.2206],[-99.21703,20.22096],[-99.21698,20.2212],[-99.21695,20.22134],[-99.21687,20.22232],[-99.21675,20.22303],[-99.21673,20.22316],[-99.21661,20.22382],[-99.21624,20.22562],[-99.21602,20.22683],[-99.21582,20.22775],[-99.21558,20.22877],[-99.21558,20.22877],[-99.21492,20.22893],[-99.21469,20.22902],[-99.21469,20.22902],[-99.21466,20.22927],[-99.21407,20.22919],[-99.21407,20.22919],[-99.21403,20.22946],[-99.21403,20.22946],[-99.21348,20.22941],[-99.21342,20.22941],[-99.21242,20.22929],[-99.21131,20.22914],[-99.21033,20.22903],[-99.21033,20.22903],[-99.21012,20.2302],[-99.21009,20.23038],[-99.20998,20.23099],[-99.20991,20.23142],[-99.20979,20.23212],[-99.2097,20.23264],[-99.20962,20.23308],[-99.20957,20.23337],[-99.20957,20.23337]];let _0x1f5b61=[];const _0xc88554=0x320;let _0x14b7db=![];try{for(let _0xb45752=0x0;_0xb45752<_0x35ff61[_0x168dd3(0x1dc)];_0xb45752++){const _0x522aa1=_0x35ff61[_0xb45752],_0x505f83=_0x522aa1[0x1],_0x2142fd=_0x522aa1[0x0],_0x5bb75e=Math[_0x168dd3(0x243)](Math[_0x168dd3(0x305)]()*0x28)+0x14,_0x4f786c=Math[_0x168dd3(0x2bb)](0xa,0x64-Math[_0x168dd3(0x243)](_0xb45752/_0x35ff61[_0x168dd3(0x1dc)]*0xf)),_0x3e030b=new Date();_0x3e030b[_0x168dd3(0x2e7)](_0x3e030b[_0x168dd3(0x2ed)]()-(_0x35ff61['length']-_0xb45752));const _0x40a145=_0x3e030b['toISOString']();let _0x3af01c=Math[_0x168dd3(0x243)](Math['random']()*0x6)-0x3,_0x51f858=Math[_0x168dd3(0x305)]()<0.05;if(_0x51f858){_0x3af01c=Math['floor'](Math['random']()*0x14)+0x32,console[_0x168dd3(0x1a8)](_0x168dd3(0x207)),showAlert(_0x168dd3(0x272)+_0x3af01c+'¬∞)',_0x168dd3(0x2f5));const _0x4c2890=doc(collection(db,'dispositivos',currentVehicleId,_0x168dd3(0x1c8)));await setDoc(_0x4c2890,{'tipo':_0x168dd3(0x1da),'valor':_0x3af01c,'mensaje':'Ca√≠da\x20detectada\x20('+_0x3af01c+'¬∞)','timestamp':_0x40a145});}let _0x352f5d=Math[_0x168dd3(0x305)]()<0.05;if(_0x352f5d){_0x14b7db=!_0x14b7db;const _0x380825=_0x14b7db?_0x168dd3(0x25d):_0x168dd3(0x303);console[_0x168dd3(0x1a8)](_0x168dd3(0x23d)+_0x380825+'!'),showAlert(_0x380825,_0x14b7db?_0x168dd3(0x2f5):_0x168dd3(0x213));const _0x1a75f7=doc(collection(db,_0x168dd3(0x30e),currentVehicleId,'events'));await setDoc(_0x1a75f7,{'tipo':_0x168dd3(0x241),'activado':_0x14b7db,'mensaje':_0x380825,'timestamp':_0x40a145});}updateMapLocation(_0x505f83,_0x2142fd),updateSpeed(_0x5bb75e),updateBattery(_0x4f786c),updateModelTilt(_0x3af01c),updateSliderUI(_0x3af01c);const _0x52ad38=document[_0x168dd3(0x246)](_0x168dd3(0x2da));_0x14b7db?_0x52ad38[_0x168dd3(0x2b6)]='bi\x20bi-lock-fill\x20text-danger':_0x52ad38[_0x168dd3(0x2b6)]='bi\x20bi-unlock-fill\x20text-success';checkGeofences(_0x505f83,_0x2142fd,currentVehicleGeofences);const _0x439fc7=doc(db,_0x168dd3(0x30e),currentVehicleId,_0x168dd3(0x26f),_0x40a145['replace'](/[:.]/g,'-'));await setDoc(_0x439fc7,{'bateria':_0x4f786c,'velocidad':_0x5bb75e,'inclinacion':_0x3af01c,'bloqueo':_0x14b7db,'ubicacion':new GeoPoint(_0x505f83,_0x2142fd),'timestamp':_0x40a145});if(_0xb45752===0x0||_0xb45752===_0x35ff61[_0x168dd3(0x1dc)]-0x1||_0xb45752%0x3===0x0||_0x51f858||_0x352f5d){let _0x562852=_0x168dd3(0x1ff);if(_0x51f858)_0x562852=_0x168dd3(0x2ce);else{if(_0x352f5d)_0x562852=_0x14b7db?_0x168dd3(0x2fb):_0x168dd3(0x1ea);}_0x1f5b61['push']({'name':_0x562852,'duration':'1\x20min','lat':_0x505f83,'lng':_0x2142fd});}await sleep(_0xc88554);}const _0x50b02d=getFormattedDate(new Date()),_0x191a6f=doc(db,'dispositivos',currentVehicleId,_0x168dd3(0x2d4),_0x50b02d);await setDoc(_0x191a6f,{'summary':{'distance':_0x168dd3(0x225),'maxSpeed':_0x168dd3(0x2de)},'routePoints':_0x1f5b61}),showAlert(_0x168dd3(0x214),_0x168dd3(0x213));}catch(_0x2bbc00){console[_0x168dd3(0x2f5)]('Error\x20en\x20demo:',_0x2bbc00),showAlert(_0x168dd3(0x2a0)+_0x2bbc00[_0x168dd3(0x1fc)],_0x168dd3(0x2f5));}finally{if(_0x52204b)_0x52204b['disabled']=![];}}async function loadAnalysisData(_0x5e4cd6){const _0x394ec8=a4_0x261970,_0x36c2c2=document['getElementById']('history-analysis-pane');if(!_0x36c2c2)return;_0x36c2c2[_0x394ec8(0x23b)]='<div\x20class=\x22text-center\x20py-5\x22><div\x20class=\x22spinner-border\x20text-primary\x22></div><p\x20class=\x22mt-2\x22>Calculando\x20KPIs...</p></div>';try{const _0x22fd5b=query(collection(db,_0x394ec8(0x30e),_0x5e4cd6,_0x394ec8(0x26f)),orderBy(_0x394ec8(0x25e),'desc'),limit(0x64)),_0x54de60=query(collection(db,'dispositivos',_0x5e4cd6,_0x394ec8(0x1c8)),orderBy(_0x394ec8(0x25e),_0x394ec8(0x242)),limit(0x32)),_0x568dd8=query(collection(db,'dispositivos',_0x5e4cd6,_0x394ec8(0x2d4)),limit(0x7)),[_0x311bb6,_0x44ff7a,_0x58716f]=await Promise['all']([getDocs(_0x22fd5b),getDocs(_0x54de60),getDocs(_0x568dd8)]),_0x2c0a47=_0x311bb6[_0x394ec8(0x1c5)][_0x394ec8(0x26a)](_0x5aa772=>_0x5aa772['data']())[_0x394ec8(0x26b)](),_0x50345f=_0x44ff7a[_0x394ec8(0x1c5)]['map'](_0x228dc1=>_0x228dc1[_0x394ec8(0x2d1)]()),_0x1ac493=_0x58716f[_0x394ec8(0x1c5)]['map'](_0x50e31e=>_0x50e31e[_0x394ec8(0x2d1)]());renderAnalysisUI(_0x36c2c2,_0x2c0a47,_0x50345f,_0x1ac493);}catch(_0x105bbe){console['error'](_0x394ec8(0x319),_0x105bbe),_0x36c2c2['innerHTML']='<div\x20class=\x22alert\x20alert-danger\x20m-3\x22>Error\x20al\x20cargar\x20datos:\x20'+_0x105bbe[_0x394ec8(0x1fc)]+_0x394ec8(0x1b6);}}function renderAnalysisUI(_0x2bb5b4,_0x4e4895,_0x3bd41e,_0x550809){const _0x5c3f9e=a4_0x261970,_0x5c061a=calculateSafetyKPI(_0x3bd41e),_0x224e01=calculateGeofenceKPI(_0x4e4895),_0x37c09d=calculateEfficiencyKPI(_0x550809),_0x459789=calculateBatteryHealthKPI(_0x4e4895);_0x2bb5b4[_0x5c3f9e(0x23b)]=_0x5c3f9e(0x1e7)+_0x5c061a[_0x5c3f9e(0x1ba)]+_0x5c3f9e(0x208)+_0x5c061a[_0x5c3f9e(0x1ba)]+_0x5c3f9e(0x274)+_0x5c061a[_0x5c3f9e(0x279)]+_0x5c3f9e(0x2e2)+_0x5c061a[_0x5c3f9e(0x1ba)]+_0x5c3f9e(0x1a1)+_0x5c061a[_0x5c3f9e(0x1ba)]+_0x5c3f9e(0x1d5)+_0x5c061a[_0x5c3f9e(0x234)]+_0x5c3f9e(0x1ad)+_0x224e01[_0x5c3f9e(0x1ba)]+_0x5c3f9e(0x2e5)+_0x224e01['status']+_0x5c3f9e(0x274)+_0x224e01[_0x5c3f9e(0x279)]+_0x5c3f9e(0x2e2)+_0x224e01[_0x5c3f9e(0x1ba)]+_0x5c3f9e(0x1a1)+_0x224e01[_0x5c3f9e(0x1ba)]+_0x5c3f9e(0x1d5)+_0x224e01[_0x5c3f9e(0x234)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22small\x20text-muted\x20mt-1\x22>Tiempo\x20en\x20zona</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22col-md-3\x20col-6\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x20h-100\x20border-primary\x20shadow-sm\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x20text-center\x20p-2\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<small\x20class=\x22text-muted\x20fw-bold\x22>USO</small>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20class=\x22display-6\x20fw-bold\x20text-primary\x20my-2\x22>'+_0x37c09d[_0x5c3f9e(0x279)]+'</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22badge\x20bg-primary\x20bg-opacity-10\x20text-primary\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x37c09d[_0x5c3f9e(0x234)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22small\x20text-muted\x20mt-1\x22>Distancia\x20recorrida</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22col-md-3\x20col-6\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card\x20h-100\x20border-'+_0x459789['status']+_0x5c3f9e(0x1e3)+_0x459789['status']+_0x5c3f9e(0x274)+_0x459789['value']+_0x5c3f9e(0x2e2)+_0x459789['status']+_0x5c3f9e(0x1a1)+_0x459789['status']+_0x5c3f9e(0x1d5)+_0x459789[_0x5c3f9e(0x234)]+_0x5c3f9e(0x1a7)+(_0x3bd41e[_0x5c3f9e(0x1dc)]===0x0?'<li\x20class=\x22list-group-item\x20text-muted\x20text-center\x20py-4\x22>Sin\x20eventos\x20recientes.</li>':'')+_0x5c3f9e(0x2d5)+_0x3bd41e[_0x5c3f9e(0x26a)](_0x10c69c=>{const _0x5a2dcb=_0x5c3f9e,_0x3b4c49=new Date(_0x10c69c['timestamp']),_0x8cfc2=_0x3b4c49[_0x5a2dcb(0x282)]([],{'hour':_0x5a2dcb(0x31f),'minute':_0x5a2dcb(0x31f)}),_0x4e3fb6=_0x3b4c49[_0x5a2dcb(0x230)]();let _0x50eec5=_0x5a2dcb(0x299),_0x18890c='';if(_0x10c69c[_0x5a2dcb(0x1d2)]==='inclinacion')_0x50eec5=_0x5a2dcb(0x2eb),_0x18890c=_0x5a2dcb(0x193);else _0x10c69c[_0x5a2dcb(0x1d2)]===_0x5a2dcb(0x241)&&(_0x50eec5=_0x10c69c[_0x5a2dcb(0x21a)]?_0x5a2dcb(0x259):_0x5a2dcb(0x2c5));return'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<li\x20class=\x22list-group-item\x20d-flex\x20align-items-start\x20'+_0x18890c+_0x5a2dcb(0x1cf)+_0x50eec5+'\x20fs-5\x22></i></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fw-bold\x20small\x22>'+(_0x10c69c[_0x5a2dcb(0x273)]||'Evento\x20detectado')+_0x5a2dcb(0x2a4)+_0x4e3fb6+'\x20-\x20'+_0x8cfc2+_0x5a2dcb(0x306);})[_0x5c3f9e(0x19b)]('')+_0x5c3f9e(0x288),drawBatteryChart(_0x4e4895);}function drawBatteryChart(_0x311b02){const _0x3d46d6=a4_0x261970,_0x2a7dbe=document[_0x3d46d6(0x236)](_0x3d46d6(0x22c));if(!_0x2a7dbe)return;const _0x2fdf2f=_0x311b02[_0x3d46d6(0x26a)](_0x22e05e=>{const _0x4630c9=_0x3d46d6,_0x205031=new Date(_0x22e05e['timestamp']);return _0x205031[_0x4630c9(0x252)]()+':'+(_0x205031[_0x4630c9(0x2ed)]()<0xa?'0':'')+_0x205031[_0x4630c9(0x2ed)]();}),_0x39281c=_0x311b02['map'](_0x4efcd8=>_0x4efcd8['bateria']);batteryChartInstance=new Chart(_0x2a7dbe,{'type':'line','data':{'labels':_0x2fdf2f,'datasets':[{'label':_0x3d46d6(0x2fc),'data':_0x39281c,'borderColor':'#10b981','backgroundColor':'rgba(16,\x20185,\x20129,\x200.1)','tension':0.4,'fill':!![]}]},'options':{'responsive':!![],'maintainAspectRatio':![],'scales':{'y':{'beginAtZero':![],'min':0x0,'max':0x64}},'plugins':{'legend':{'display':![]}}}});}document[a4_0x261970(0x264)](a4_0x261970(0x2fe),function unlockAudio(){const _0x2f6f35=a4_0x261970;notificationSound[_0x2f6f35(0x247)]()[_0x2f6f35(0x1d0)](()=>{const _0x530dd3=_0x2f6f35;notificationSound[_0x530dd3(0x301)](),notificationSound['currentTime']=0x0;})[_0x2f6f35(0x262)](()=>{}),document[_0x2f6f35(0x2fa)](_0x2f6f35(0x2fe),unlockAudio);},{'once':!![]});function calculateSafetyKPI(_0x9ac2cb){const _0x101e25=a4_0x261970,_0x1788d0=_0x9ac2cb[_0x101e25(0x219)](_0x308052=>_0x308052[_0x101e25(0x1d2)]===_0x101e25(0x1da))[_0x101e25(0x1dc)],_0x3991b1=_0x1788d0===0x0?_0x101e25(0x213):_0x101e25(0x2ad),_0x338d2d=_0x1788d0===0x0?'Seguro':_0x101e25(0x1bd);return{'value':_0x1788d0,'status':_0x3991b1,'text':_0x338d2d};}function calculateGeofenceKPI(_0x29373c){const _0x2c9491=a4_0x261970;if(_0x29373c[_0x2c9491(0x1dc)]===0x0||currentVehicleGeofences[_0x2c9491(0x1dc)]===0x0)return{'value':0x0,'status':_0x2c9491(0x2dc),'text':_0x2c9491(0x1bf)};let _0x4d03f5=0x0;_0x29373c['forEach'](_0x400f8d=>{const _0x5c0661=_0x2c9491;let _0x161281=![];if(_0x400f8d[_0x5c0661(0x1cd)])for(const _0x1d3f1a of currentVehicleGeofences){const _0x2a2cd1=getDistance(_0x400f8d[_0x5c0661(0x1cd)][_0x5c0661(0x232)],_0x400f8d['ubicacion']['longitude'],_0x1d3f1a[_0x5c0661(0x2ea)],_0x1d3f1a[_0x5c0661(0x316)]);if(_0x2a2cd1<=_0x1d3f1a[_0x5c0661(0x22d)]){_0x161281=!![];break;}}if(_0x161281)_0x4d03f5++;});const _0x568b85=Math[_0x2c9491(0x295)](_0x4d03f5/_0x29373c[_0x2c9491(0x1dc)]*0x64);let _0x5dfc53=_0x2c9491(0x2ad);if(_0x568b85>=0x50)_0x5dfc53=_0x2c9491(0x213);else{if(_0x568b85>=0x32)_0x5dfc53=_0x2c9491(0x1b7);}return{'value':_0x568b85+'%','status':_0x5dfc53,'text':_0x2c9491(0x25b)};}function calculateEfficiencyKPI(_0x538f22){const _0x5ef7f9=a4_0x261970;let _0x1b4c71=0x0;return _0x538f22['forEach'](_0x118bdb=>{const _0x33b3d1=a4_0x18ff;if(_0x118bdb[_0x33b3d1(0x221)]&&_0x118bdb[_0x33b3d1(0x221)][_0x33b3d1(0x23a)]){const _0x2e700c=_0x118bdb[_0x33b3d1(0x221)][_0x33b3d1(0x23a)],_0x11c2c6=parseFloat(_0x2e700c['split']('\x20')[0x0]);if(!isNaN(_0x11c2c6))_0x1b4c71+=_0x11c2c6;}}),_0x1b4c71=Math[_0x5ef7f9(0x295)](_0x1b4c71*0xa)/0xa,{'value':_0x1b4c71+_0x5ef7f9(0x27c),'status':_0x5ef7f9(0x2ff),'text':'√öltimos\x207\x20d√≠as'};}function calculateBatteryHealthKPI(_0x2f6247){const _0x4e20f7=a4_0x261970;if(_0x2f6247[_0x4e20f7(0x1dc)]===0x0)return{'value':'--','status':'secondary'};let _0x140317=0x64;_0x2f6247[_0x4e20f7(0x1e4)](_0x56606f=>{const _0x39deac=_0x4e20f7;if(_0x56606f[_0x39deac(0x2df)]<_0x140317)_0x140317=_0x56606f[_0x39deac(0x2df)];});let _0x2b360a=_0x4e20f7(0x213);if(_0x140317<0x14)_0x2b360a=_0x4e20f7(0x2ad);else{if(_0x140317<0x32)_0x2b360a=_0x4e20f7(0x1b7);}return{'value':_0x140317+'%','status':_0x2b360a,'text':_0x4e20f7(0x289)};}async function toggleMotorLock(){const _0x28277a=a4_0x261970;if(!currentVehicleId)return showAlert(_0x28277a(0x2d9),_0x28277a(0x2f5));if(isTogglingLock)return;isTogglingLock=!![];const _0xbfb299=document[_0x28277a(0x236)](_0x28277a(0x1d9));if(_0xbfb299)_0xbfb299[_0x28277a(0x271)]['opacity']=_0x28277a(0x298);try{const _0x942c64=!isVehicleLocked,_0x38e57d=doc(db,_0x28277a(0x30e),currentVehicleId);await updateDoc(_0x38e57d,{'bloqueo':_0x942c64}),console['log'](_0x28277a(0x284)+(_0x942c64?'BLOQUEADO':_0x28277a(0x1a2))),showAlert(_0x942c64?_0x28277a(0x1f6):_0x28277a(0x2fd),_0x942c64?_0x28277a(0x2f5):_0x28277a(0x213));}catch(_0x2b2722){console[_0x28277a(0x2f5)](_0x28277a(0x31a),_0x2b2722),showAlert(_0x28277a(0x2b2),_0x28277a(0x2f5));}finally{isTogglingLock=![];if(_0xbfb299)_0xbfb299[_0x28277a(0x271)][_0x28277a(0x1ca)]='1';}}function checkTheftMovement(_0x1d4797,_0x56dbed,_0x2cd029){const _0x56ef45=a4_0x261970;if(!_0x2cd029){lastLockedLocation=null;return;}if(lastLockedLocation===null){lastLockedLocation={'lat':_0x1d4797,'lon':_0x56dbed};return;}const _0x275758=getDistance(_0x1d4797,_0x56dbed,lastLockedLocation['lat'],lastLockedLocation[_0x56ef45(0x316)]);if(_0x275758>0x5){const _0x41aef3=_0x56ef45(0x2a5)+Math['round'](_0x275758)+'m';showAlert(_0x41aef3,_0x56ef45(0x2f5));const _0x13abb0=Date['now']();(!window[_0x56ef45(0x254)]||_0x13abb0-window[_0x56ef45(0x254)]>0xea60)&&(sendWhatsAppAlert(_0x41aef3),window['lastWaSent']=_0x13abb0),lastLockedLocation={'lat':_0x1d4797,'lon':_0x56dbed};}}async function sendWhatsAppAlert(_0x49fe33){const _0x37aade=a4_0x261970;if(!whatsappAlertsEnabled){console[_0x37aade(0x1a8)](_0x37aade(0x2f0));return;}if(!waPhone||!waApiKey){console[_0x37aade(0x24f)](_0x37aade(0x2cf));return;}const _0x3aabe0=encodeURIComponent('üö®\x20RiderSafe:\x20'+_0x49fe33),_0x492fcc=_0x37aade(0x2aa)+waPhone+_0x37aade(0x227)+_0x3aabe0+_0x37aade(0x1f8)+waApiKey;try{console['log'](_0x37aade(0x256)+_0x49fe33+_0x37aade(0x27d)),await fetch(_0x492fcc,{'mode':'no-cors'}),console[_0x37aade(0x1a8)]('‚úÖ\x20[WhatsApp]\x20Petici√≥n\x20enviada.');}catch(_0x3c701b){console['error']('‚ùå\x20[WhatsApp]\x20Error\x20de\x20red:',_0x3c701b);}}function updateUIFromData(_0x322bc8,_0x38dfa1){const _0x32c30b=a4_0x261970;updateBattery(_0x322bc8[_0x32c30b(0x2df)]||0x0),updateSpeed(_0x322bc8[_0x32c30b(0x249)]||0x0);const _0x206632=_0x322bc8['inclinacion']||0x0;updateModelTilt(_0x206632),updateSliderUI(_0x206632),checkTiltStatus(_0x206632),isVehicleLocked=_0x322bc8[_0x32c30b(0x241)]||![];const _0x29782a=document['getElementById'](_0x32c30b(0x27e));_0x29782a&&(isVehicleLocked?_0x29782a[_0x32c30b(0x23b)]=_0x32c30b(0x209):_0x29782a[_0x32c30b(0x23b)]=_0x32c30b(0x217));const _0x52f51c=_0x322bc8[_0x32c30b(0x2a8)]||currentVehicleId,_0x3454a4=document['getElementById'](_0x32c30b(0x215));if(_0x3454a4)_0x3454a4[_0x32c30b(0x260)]=_0x52f51c;const _0x4596c0=document[_0x32c30b(0x236)](_0x32c30b(0x308));if(_0x4596c0)_0x4596c0[_0x32c30b(0x279)]=_0x52f51c;if(_0x322bc8[_0x32c30b(0x1cd)]&&_0x322bc8[_0x32c30b(0x1cd)]['latitude']&&_0x322bc8['ubicacion'][_0x32c30b(0x269)]){const _0x1ddfcd=_0x322bc8[_0x32c30b(0x1cd)][_0x32c30b(0x232)],_0x49fd6b=_0x322bc8['ubicacion'][_0x32c30b(0x269)];updateMapLocation(_0x1ddfcd,_0x49fd6b),checkGeofences(_0x1ddfcd,_0x49fd6b,_0x38dfa1),checkTheftMovement(_0x1ddfcd,_0x49fd6b,isVehicleLocked);}else checkGeofences(null,null,_0x38dfa1);const _0x17398f=currentVehicleGeofences[_0x32c30b(0x26a)](_0x3d19f5=>''+_0x3d19f5['id']+_0x3d19f5['name']+_0x3d19f5[_0x32c30b(0x22d)]+_0x3d19f5[_0x32c30b(0x2ea)]+_0x3d19f5['lon']+_0x3d19f5[_0x32c30b(0x290)])[_0x32c30b(0x19b)](),_0x491914=_0x38dfa1[_0x32c30b(0x26a)](_0xab4d=>''+_0xab4d['id']+_0xab4d['name']+_0xab4d[_0x32c30b(0x22d)]+_0xab4d[_0x32c30b(0x2ea)]+_0xab4d['lon']+_0xab4d[_0x32c30b(0x290)])['join']();_0x17398f!==_0x491914&&(console[_0x32c30b(0x1a8)]('[Geofence]\x20Detectado\x20cambio\x20en\x20la\x20configuraci√≥n\x20de\x20geocercas,\x20redibujando.'),updateGeofenceListUI(_0x38dfa1),drawGeofencesOnMap(_0x38dfa1),loadGeofencesInModal(_0x38dfa1)),currentVehicleGeofences=_0x38dfa1;}function checkTiltStatus(_0x3ea9bb){const _0x15a875=a4_0x261970,_0xc11f8d=Math['abs'](_0x3ea9bb);let _0xb5f5a8=_0x15a875(0x2b5),_0x6132f6='';if(_0xc11f8d>0x46)_0xb5f5a8=_0x15a875(0x2af);else{if(_0xc11f8d>0x2d)_0xb5f5a8=_0x15a875(0x2ad);else _0xc11f8d>=0x26&&(_0xb5f5a8='warning');}if(_0xb5f5a8!==lastTiltZone){if(_0xb5f5a8===_0x15a875(0x1b7))_0x6132f6=_0x15a875(0x1bb)+_0x3ea9bb+'¬∞)',showAlert(_0x6132f6,_0x15a875(0x1b7));else{if(_0xb5f5a8===_0x15a875(0x2ad))_0x6132f6='üõë\x20PELIGRO:\x20Inclinaci√≥n\x20cr√≠tica\x20('+_0x3ea9bb+'¬∞)',showAlert(_0x6132f6,'error');else _0xb5f5a8===_0x15a875(0x2af)&&(_0x6132f6=_0x15a875(0x2bf)+_0x3ea9bb+'¬∞)',showAlert(_0x6132f6,_0x15a875(0x2f5)),sendWhatsAppAlert(_0x6132f6));}lastTiltZone=_0xb5f5a8;}}export{initDashboard};function a4_0x9da99d(_0x3bf3cb){function _0x37749b(_0x26e35f){const _0x2e1aa8=a4_0x18ff;if(typeof _0x26e35f==='string')return function(_0x4c2646){}['constructor'](_0x2e1aa8(0x1d6))[_0x2e1aa8(0x1a6)](_0x2e1aa8(0x1fe));else(''+_0x26e35f/_0x26e35f)[_0x2e1aa8(0x1dc)]!==0x1||_0x26e35f%0x14===0x0?function(){return!![];}[_0x2e1aa8(0x1d1)](_0x2e1aa8(0x257)+'gger')[_0x2e1aa8(0x19d)]('action'):function(){return![];}['constructor'](_0x2e1aa8(0x257)+_0x2e1aa8(0x28f))[_0x2e1aa8(0x1a6)](_0x2e1aa8(0x1cb));_0x37749b(++_0x26e35f);}try{if(_0x3bf3cb)return _0x37749b;else _0x37749b(0x0);}catch(_0x2ea371){}}